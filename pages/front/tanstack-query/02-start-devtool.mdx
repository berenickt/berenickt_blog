---
title: '02-ë¹ ë¥¸ ì‹œì‘ ë° ê°œë°œë„êµ¬'
date: 2023/12/14
---

## 1. ë¹ ë¥¸ ì‹œì‘

React QueryëŠ” 3ê°€ì§€ í•µì‹¬ ê°œë…ì„ ê°€ì§„ë‹¤.

- `Queries` (ë°ì´í„° ì§ˆë¬¸ê³¼ ê´€ë ¨ëœ ê²ƒ, (ë°ì´í„° ìˆëŠ”ì§€ ì§ˆë¬¸(=ì¡°íšŒ)))
- `Mutations` (ë°ì´í„° ë³€í™”ì™€ ê´€ë ¨ëœ ê²ƒ, (ìƒì„±, ìˆ˜ì •, ì‚­ì œ))
- `Query Invalidation` (queryê°€ ìœ íš¨í•œì§€ ê²€ì¦)

[CodesandBox Example](https://codesandbox.io/p/devbox/tanstack-query-example-react-simple-lskn7u?embed=1&file=%2Fsrc%2Findex.jsx%3A12%2C38)

```tsx
import { useQuery, useMutation, useQueryClient, QueryClient, QueryClientProvider } from '@tanstack/react-query'
import { getTodos, postTodo } from '../my-api'

// Create a client
const queryClient = new QueryClient()

function App() {
  return (
    // Provide the client to your App
    <QueryClientProvider client={queryClient}>
      <Todos />
    </QueryClientProvider>
  )
}

function Todos() {
  // Access the client
  const queryClient = useQueryClient()

  // Queries
  const query = useQuery({ queryKey: ['todos'], queryFn: getTodos })

  // Mutations
  const mutation = useMutation({
    mutationFn: postTodo,
    onSuccess: () => {
      // Invalidate and refetch
      queryClient.invalidateQueries({ queryKey: ['todos'] })
    },
  })

  return (
    <div>
      <ul>{query.data?.map(todo => <li key={todo.id}>{todo.title}</li>)}</ul>

      <button
        onClick={() => {
          mutation.mutate({
            id: Date.now(),
            title: 'Do Laundry',
          })
        }}
      >
        Add Todo
      </button>
    </div>
  )
}

render(<App />, document.getElementById('root'))
```

---

## 2. ê°œë°œë„êµ¬(Devtools)

React QueryëŠ” ì „ìš© devtoolsì™€ í•¨ê»˜ ì œê³µí•œë‹¤.

> 2024.12.12 ê¸°ì¤€
>
> í˜„ì¬ devtoolsëŠ” React Nativeë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
> ë˜í•œ DevToolsë¥¼ ì‚¬ìš©í•˜ì—¬ Queriesë¥¼ ê´€ì°°í•  ìˆ˜ ìˆì§€ë§Œ, Mutationsì€ ê´€ì°° ë¶ˆê°€ëŠ¥
> https://tanstack.com/query/latest/docs/react/devtools#install-and-import-the-devtools

---

### 2.1 ì„¤ì¹˜

devtoolsëŠ” ì„¤ì¹˜í•´ì•¼ í•˜ëŠ” ë³„ë„ì˜ íŒ¨í‚¤ì§€ì´ë‹¤.

```bash
$ npm i @tanstack/react-query-devtools
# or
$ pnpm add @tanstack/react-query-devtools
# or
$ yarn add @tanstack/react-query-devtools
```

Next 13+ App Dirì˜ ê²½ìš°, ì‘ë™í•˜ë ¤ë©´ dev ì¢…ì†ì„±ìœ¼ë¡œ ì„¤ì¹˜í•´ì•¼ í•œë‹¤.

ë‹¤ìŒê³¼ ê°™ì´ devtoolsë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.

```tsx
import { ReactQueryDevtools } from '@tanstack/react-query-devtools'
```

---

### 2.2 í”Œë¡œíŒ…(Floating) Mode

- í”Œë¡œíŒ… ëª¨ë“œëŠ” í™”ë©´ ëª¨ì„œë¦¬ì— í† ê¸€ì„ ì œê³µí•´ì„œ, devtoolsë¥¼ í‘œì‹œí•˜ê±°ë‚˜ ìˆ¨ê¸°ëŠ” ê¸°ëŠ¥
- ì´ í† ê¸€ ìƒíƒœëŠ” ë‹¤ì‹œ ë¡œë“œí•  ë–„, localStorageì— ì €ì¥ë˜ê³  ê¸°ì–µë¨
- React ì•±ì—ì„œ ê°€ëŠ¥í•œ ìµœìƒë‹¨ì— ë°°ì¹˜í•  ìˆ˜ë¡ ì˜ ì‘ë™í•¨ (e.g. í˜ì´ì§€ root íŒŒì¼)

```tsx
import { ReactQueryDevtools } from '@tanstack/react-query-devtools'

function App() {
  return (
    <QueryClientProvider client={queryClient}>
      {/* The rest of your application */}
      <ReactQueryDevtools initialIsOpen={false} />
    </QueryClientProvider>
  )
}
```

---

### 2.3 Devtools ì˜µì…˜

ReactQueryDevtoolsì˜ ì˜µì…˜ì€ ê³µì‹ë¬¸ì„œ ì°¸ê³ 

- https://tanstack.com/query/latest/docs/react/devtools#options

---

### 2.4 production(ì‹¤ì œ ìš´ì˜í™˜ê²½) êµ¬ê°„ì—ì„œ Devtools

DevtoolsëŠ” í”„ë¡œë•ì…˜ ë¹Œë“œ ë‹¨ê³„ì—ì„œ ì œì™¸ëœë‹¤.
ê·¸ëŸ¬ë‚˜ í”„ë¡œë•ì…˜ ë‹¨ê³„ì—ì„œ devtoolsë¥¼ ì§€ì—° ë¡œë“œí•˜ëŠ” ê²ƒì´ ë°”ëŒì§í•  ìˆ˜ ìˆìŒ.

```tsx
import * as React from 'react'
import { QueryClient, QueryClientProvider } from '@tanstack/react-query'
import { ReactQueryDevtools } from '@tanstack/react-query-devtools'
import { Example } from './Example'

const queryClient = new QueryClient()

const ReactQueryDevtoolsProduction = React.lazy(() =>
  import('@tanstack/react-query-devtools/build/modern/production.js').then(d => ({
    default: d.ReactQueryDevtools,
  })),
)

function App() {
  const [showDevtools, setShowDevtools] = React.useState(false)

  React.useEffect(() => {
    // @ts-ignore
    window.toggleDevtools = () => setShowDevtools(old => !old)
  }, [])

  return (
    <QueryClientProvider client={queryClient}>
      <Example />
      <ReactQueryDevtools initialIsOpen />
      {showDevtools && (
        <React.Suspense fallback={null}>
          <ReactQueryDevtoolsProduction />
        </React.Suspense>
      )}
    </QueryClientProvider>
  )
}

export default App
```

ì´ë¥¼ í†µí•´ window.toggleDevtools()ë¥¼ í˜¸ì¶œí•˜ë©´, devtools ë²ˆë“¤ì„ ë‹¤ìš´ë¡œë“œí•˜ì—¬ í‘œì‹œí•¨

---

### 2.5 ìµœì‹  ë²ˆë“¤ëŸ¬

ë²ˆë“¤ëŸ¬ê°€ íŒ¨í‚¤ì§€ ë‚´ë³´ë‚´ê¸°ë¥¼ ì§€ì›í•˜ëŠ” ê²½ìš° ë‹¤ìŒ ê°€ì ¸ì˜¤ê¸° ê²½ë¡œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx
const ReactQueryDevtoolsProduction = React.lazy(() =>
  import('@tanstack/react-query-devtools/production').then(d => ({
    default: d.ReactQueryDevtools,
  })),
)
```

TypeScriptì˜ ê²½ìš° TypeScript v4.7 ì´ìƒì´ í•„ìš”í•œ tsconfigì—ì„œ `moduleResolution: 'nodenext'` ì„¤ì •í•´ì•¼ í•œë‹¤.

---

## 3. íƒ€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ ë¹„êµ

- react-queryíŒ€ì—ì„œ í¸í–¥ë˜ì§€ ì•Šë„ë¡ ë…¸ë ¥í•´ì„œ íƒ€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ ë¹„êµí–ˆë‹¤ê³  í•¨
- https://tanstack.com/query/latest/docs/react/comparison
- í•˜ë‹¨ì— `githubì—ì„œ ì´ í˜ì´ì§€ í¸ì§‘ ë²„íŠ¼`ì„ ëˆŒëŸ¬ ì •ë³´ê°€ í¸í–¥ë˜ì§€ ì•Šë„ë¡ ìˆ˜ì • ê°€ëŠ¥í•¨

ì•„ì´ì½˜ ë³„ ì˜ë¯¸

- âœ… : ì§€ì›ë¨
- ğŸŸ¡ : ì§€ì›O, ë¹„ê³µì‹
- ğŸ”¶ : ì§€ì›O, ë¬¸ì„œí™”O, but êµ¬í˜„ ì‹œ ì¶”ê°€ ì‚¬ìš©ì ì½”ë“œ í•„ìš”
- ğŸ›‘ : ì§€ì›O, ë¬¸ì„œí™”X

- React Query
- SWR
- Apollo Client
- RTK-Query
- React Router

ê°ì react-query ê³µì‹ë¬¸ì„œ ë³´ê³ , ë­ê°€ ì¢‹ì€ì§€ ìê¸° ìƒí•­ì— ë§ê²Œ íŒë‹¨í•˜ë©´ ëœë‹¤.
