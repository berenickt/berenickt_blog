---
title: '01-ì†Œê°œ ë° ì„¤ì¹˜'
date: 2023/12/14
---

# React-Query - REST

- https://tanstack.com/query/latest/
- ê³µì‹ë¬¸ì„œ ë”°ë¼ì„œ Tanstack-query v5 ë°°ìš°ê¸°
- `React-query`ì—ì„œ `Tanstack-query`ë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬ëª…ì„ ë°”ê¿¨ìŒ
- ê³µì‹ë¬¸ì„œ ì½ë‹¤ê°€ ì˜¤íƒ€ë‚˜ ì˜ëª» í‘œê¸°ëœ ì •ë³´ê°€ ìˆìœ¼ë©´ githubë¡œ í¸ì§‘í•´ì„œ ì•Œë ¤ì¤„ ìˆ˜ë„ ìˆë‹¤.

## 1. ì „ë°˜ì ì¸ ì†Œê°œ(overview)

- TanStack Query (FKA React Query)
  - FKA : 'formerly known as' (~ì „ì—ëŠ” ë¡œ ì•Œë ¤ì§„)
  - ë°ì´í„° ê°€ì ¸ì˜¤ê¸°(fetching) ë¿ë§Œ ì•„ë‹ˆë¼,
  - ì›¹ì•±ì—ì„œ `ì„œë²„ ìƒíƒœ(state)`ë¥¼ ê°€ì ¸ì˜¤ê³ , ìºì‹±, ë™ê¸°í™”, ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆë‹¤.

> ğŸ’¡ cache(ìºì‹œ)ì™€ ìºì‹±
>
> - ì›ë˜ ì€ë°€í•œ ì¥ì†Œì— ìˆ¨ê²¨ ë†“ì€ 'ì€ë‹‰ì²˜'ë¼ëŠ” ì˜ë¯¸ë¥¼ ì§€ë‹ˆê³  ìˆì§€ë§Œ,
> - ì»´í“¨í„° ìš©ì–´ë¡œ ì‚¬ìš©í•  ë•ŒëŠ” 'ê³ ì† ê¸°ì–µì¥ì¹˜'ë¥¼ ê°€ë¦¬í‚µë‹ˆë‹¤.
> - ì¦‰, ì»´í“¨í„°ê°€ ë¹¨ë¦¬ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ìˆë„ë¡ ì •ë³´ë¥¼ ë³´ê´€í•˜ëŠ” ë©”ëª¨ë¦¬ ë¶€ë¶„ì„ cache ë˜ëŠ” cache memoryë¼ê³  ë¶€ë¦„
>
> `ìºì‹±`ì€ ë¹ ë¥¸ ì†ë„ë¥¼ ìœ„í•´ ìºì‹œì— ë°ì´í„° ì €ì¥í•˜ëŠ” í–‰ìœ„ë¥¼ ë§í•¨

- ëŒ€ë¶€ë¶„ ì›¹ í”„ë ˆì„ì›Œí¬ì—ëŠ” ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê±°ë‚˜ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²•ì´ ì—†ìŒ.
- ì „í†µì ì¸ ìƒíƒœê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ëŠ” í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ ì‘ì—…ì— ì í•©í•˜ê³ ,
  - ë¹„ë™ê¸° or ì„œë²„ ìƒíƒœ ì‘ì—…ì´ ì í•©í•˜ì§€ ì•Šë‹¤.

> ğŸ’¡ ì„œë²„ ìƒíƒœ(server state)
>
> - ê°œë°œìê°€ ì œì–´í•˜ê±°ë‚˜ ì†Œìœ í•  ìˆ˜ ì—†ëŠ” ìœ„ì¹˜ì— ì›ê²©ìœ¼ë¡œ ì§€ì†ë˜ëŠ” ê²ƒ
> - ê°€ì ¸ì˜¤ê±°ë‚˜ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ ë¹„ë™ê¸°(asynchronous) API í•„ìš”
> - ê³µë™ ì†Œìœ ê¶Œì„ ì˜ë¯¸í•˜ë©°, ë‹˜ë„ ëª¨ë¥´ê²Œ ë‹¤ë¥¸ ì‚¬ëŒì— ì˜í•´ ë³€ê²½ ë  ìˆ˜ ìˆìŒ
> - ì£¼ì˜í•˜ì§€ ì•Šìœ¼ë©´, ë‹˜ ì•±ì´ ì ì¬ì ìœ¼ë¡œ "êµ¬ì‹"ì´ ë  ìˆ˜ ìˆë‹¤.

ì¼ë‹¨ ë‹˜ì´ ì„œë²„ ìƒíƒœì˜ íŠ¹ì§•(nature)ì„ íŒŒì•…(grasp)í–ˆë‹¤ë©´, ë‹¤ìŒê³¼ ê°™ì´ ë” ë§ì€ ë¬¸ì œê°€ ì¡´ì¬í•¨

- ìºì‹±...
- ë™ì¼í•œ ë°ì´í„°ì— ëŒ€í•œ ì—¬ëŸ¬ ìš”ì²­ì„ ë‹¨ì¼ ìš”ì²­ìœ¼ë¡œ ì¤‘ë³µ ì œê±°
- ë°±ê·¸ë¼ìš´ë“œì—ì„œ "ì˜¤ë˜ëœ" ë°ì´í„° ì—…ë°ì´íŠ¸
- ë°ì´í„°ê°€ "ì˜¤ë˜ëœ" ì‹œì  íŒŒì•…
- ê°€ëŠ¥í•œ í•œ ë¹¨ë¦¬ ë°ì´í„° ì—…ë°ì´íŠ¸ ë°˜ì˜
- í˜ì´ì§€ ë§¤ê¹€ ë° ì§€ì—° ë¡œë”© ë°ì´í„°ì™€ ê°™ì€ ì„±ëŠ¥ ìµœì í™”
- ì„œë²„ ìƒíƒœì˜ ë©”ëª¨ë¦¬ ë° ê°€ë¹„ì§€ì»¬ë ‰ì…˜ ê´€ë¦¬
  - cf. ê°€ë¹„ì§€ì»¬ë ‰ì…˜ : ë©”ëª¨ë¦¬ ê´€ë¦¬ ê¸°ë²• ì¤‘ í•˜ë‚˜ë¡œ í”„ë¡œê·¸ë¨ì´ ë™ì ìœ¼ë¡œ í• ë‹¹í–ˆë˜ ë©”ëª¨ë¦¬ ì˜ì—­ ì¤‘ì—ì„œ í•„ìš”ì—†ê²Œ ëœ ì˜ì—­ì„ í•´ì œí•˜ëŠ” ê¸°ëŠ¥
- êµ¬ì¡°ì  ê³µìœ ë¡œ ì¿¼ë¦¬ ê²°ê³¼ ë©”ëª¨ì´ì§•(cf. Memoizing : ë©”ëª¨ë¦¬ì¨ì„œ ì €ì¥í•´ë†“ëŠ” ê²ƒ)

ìœ„ ë¬¸ì œë“¤ ë‹¤ í•´ê²°í–ˆìœ¼ë©´, ì²œì¬ì´ë‹ˆ react-query ì•ˆë°°ì›Œë„ ë¨.
react-queryíŒ€ë„ ìœ„ ë¬¸ì œë“¤ì˜ í‘œë©´ì ì¸ ë¶€ë¶„ì„ ì¡°ê¸ˆì”© ì²˜ë¦¬(scratching)í•˜ê³  ìˆìŒ

---

### 1.1 ê¸°ìˆ ì ì¸ ì¸¡ë©´ì—ì„œ React Query ì¥ì 

- ë³µì¡í•œ ì½”ë“œë¥¼ react-query ëª‡ ì¤„ë¡œ ëŒ€ì²´ ê°€ëŠ¥
- ìœ ì§€ ê´€ë¦¬ ì‰½ê³ , ì„œë²„ ìƒíƒœ ë°ì´í„°ë¥¼ ì¶”ê°€í•œ ìƒˆ ê¸°ëŠ¥ì„ ì‰½ê²Œ ë¹Œë“œ ê°€ëŠ¥
- ë¹¨ë¦¬ ë°ì´í„° ê°–ê³ ì™€ì„œ ì‹¤ì œ ìœ ì €ë“¤ì´ ì“°ê¸° ì¢‹ë‹¤í•¨
- ëŒ€ì—­í­ì„ ì ˆì•½í•˜ê³  ë©”ëª¨ë¦¬ ì„±ëŠ¥ì„ ë†’ì´ê¸° ì¢‹ë‹¤í•¨

---

### 1.2 ëŒ€ì¶© ì–´ë–»ê²Œ ìƒê¸´ì§€ êµ¬ê²½í•´ë³´ì

[Open in CodeSandbox](https://codesandbox.io/p/devbox/github/tannerlinsley/react-query/tree/main/examples/react/simple?file=%2Fsrc%2Findex.jsx%3A16%2C45)

```tsx
import { QueryClient, QueryClientProvider, useQuery } from '@tanstack/react-query'

// (1) ì•± rootì—ì„œ QueryClientProviderë¥¼ ì„¤ì •í•´ tanstack-query ì œê³µ
const queryClient = new QueryClient()

export default function App() {
  return (
    <QueryClientProvider client={queryClient}>
      <Example />
    </QueryClientProvider>
  )
}

function Example() {
  const { isPending, error, data } = useQuery({
    queryKey: ['repoData'],
    queryFn: () => fetch('https://api.github.com/repos/TanStack/query').then(res => res.json()),
  })

  if (isPending) return 'Loading...'

  if (error) return 'An error has occurred: ' + error.message

  return (
    <div>
      <h1>{data.name}</h1>
      <p>{data.description}</p>
      <strong>ğŸ‘€ {data.subscribers_count}</strong> <strong>âœ¨ {data.stargazers_count}</strong>{' '}
      <strong>ğŸ´ {data.forks_count}</strong>
    </div>
  )
}
```

---

## 2. ì„¤ì¹˜

React QueryëŠ” React v18+ì™€ í˜¸í™˜ë˜ë©°, ReactDOM ë° React Nativeì™€ í•¨ê»˜ ì‘ë™ë¨.

```bash
$ npm i @tanstack/react-query
# or
$ pnpm add @tanstack/react-query
# or
$ yarn add @tanstack/react-query
```

ë˜í•œ `ESLint í”ŒëŸ¬ê·¸ì¸ ì¿¼ë¦¬`ë¥¼ ì‚¬ìš©í•˜ë©´, ë²„ê·¸ì™€ ë¶ˆì¼ì¹˜ë¥¼ ì°¾ê¸° ì¢‹ë‹¤.

```bash
$ npm i -D @tanstack/eslint-plugin-query
# or
$ pnpm add -D @tanstack/eslint-plugin-query
# or
$ yarn add -D @tanstack/eslint-plugin-query
```
