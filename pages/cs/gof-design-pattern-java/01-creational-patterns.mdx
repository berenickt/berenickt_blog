---
title: '01-í–‰ë™ íŒ¨í„´'
date: 2024/06/29
---

## 1. ì‹±ê¸€í†¤(Singleton) íŒ¨í„´

![gof_1_1](https://raw.githubusercontent.com/berenickt/image-server/main/img/gof_1_1.png)

- **ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì˜¤ì§ í•œê°œë§Œ ì œê³µí•˜ëŠ” í´ë˜ìŠ¤**
- ì‹œìŠ¤í…œ ëŸ°íƒ€ì„, í™˜ê²½ ì„¸íŒ…ì— ëŒ€í•œ ì •ë³´ ë“±, ì¸ìŠ¤í„´ìŠ¤ê°€ ì—¬ëŸ¬ê°œ ì¼ ë•Œ ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆëŠ” ê²½ìš°ê°€ ìˆë‹¤.
  - ì¸ìŠ¤í„´ìŠ¤ë¥¼ `ì˜¤ì§ í•œê°œë§Œ ë§Œë“¤ì–´ ì œê³µí•˜ëŠ” í´ë˜ìŠ¤`ê°€ í•„ìš”í•˜ë‹¤.
- e.g. ê²Œì„ì˜ ì„¤ì •í™”ë©´ì´ ì—¬ëŸ¬ ê°œ ì„¤ì •í™”ë©´ì´ ì•„ë‹Œ, ì˜¤ì§ í•˜ë‚˜ì˜ ì„¤ì •í™”ë©´ì„ ê¸€ë¡œë²Œí•˜ê²Œ ì œê³µí•˜ëŠ” ê²ƒ
  - ê²Œì„ì˜ ì„¤ì •í™”ë©´ì´ ì—¬ëŸ¬ ì¸ìŠ¤í„´ìŠ¤ì˜€ë‹¤ë©´, Aë¼ëŠ” ì„¤ì •í™”ë©´, Bë¼ëŠ” ì„¤ì •í™”ë©´ ë“± ë‚œì¡í•´ì§
- cf. singletonì€ 'ë‹¨ë… ê°œì²´', 'ë…ì‹ ì'ë¼ëŠ” ëœ» ë§ê³ ë„ 'ì •í™•íˆ í•˜ë‚˜ì˜ ìš”ì†Œë§Œ ê°–ëŠ” ì§‘í•©' ë“±ì˜ ì˜ë¯¸ê°€ ìˆë‹¤

---

### 1.1 êµ¬í˜„ ë°©ë²•1-ê°€ì¥ ë‹¨ìˆœ

```java
package me.whiteship.designpatterns._01_creational_patterns._01_singleton;

import java.io.*;

public class App {

  public static void main(String[] args) {
    Settings settings = new Settings();
    Settings settings1 = new Settings()

    System.out.println(settings != settings1); // true
  }
}
```

- ì‹±ê¸€í†¤ íŒ¨í„´ì„ êµ¬í˜„í•˜ë ¤ë©´, newë¥¼ ì ˆëŒ€ ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤.
- Javaì—ì„œ newì„ ì‚¬ìš©í•´ ìƒì„±ìë¥¼ ì“°ì§€ ëª»í•˜ê²Œ ë§Œë“œë ¤ë©´,

  - `private` ìƒì„±ìë¥¼ ë§Œë“¤ì–´ì„œ,
  - í•´ë‹¹ í´ë˜ìŠ¤ ì•ˆì—ì„œë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ìƒì„±ìë¥¼ ë§Œë“¤ì–´ì£¼ë©´, í´ë˜ìŠ¤ ë°–ì—ì„œëŠ” ìƒì„±ìë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.

- ì´ë ‡ê²Œ ë˜ë©´ ë°–ì—ì„œëŠ” ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ê¸° ë–„ë¬¸ì—,
  - í•´ë‹¹ í´ë˜ìŠ¤ ì•ˆì—ì„œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ì–´ì£¼ëŠ” ë°©ë²•ì„ ê¸€ë¡œë²Œí•˜ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì œê³µí•´ì¤˜ì•¼ í•œë‹¤.
  - ì—¬ê¸°ì„œ ë§í•˜ëŠ” ê¸€ë¡œë²Œ ì ‘ê·¼ì´ ê°€ëŠ¥í•œ ë°©ë²•ì€ `static`ì„ ì œê³µí•´ì£¼ëŠ” ê²ƒì´ë‹¤.

```java
package me.whiteship.designpatterns._01_creational_patterns._01_singleton;

/**
 * private ìƒì„±ìì™€ public static ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•
 */
public class Settings1 {

  private static Settings1 instance;

  private Settings1() {}

  public static Settings1 getInstance() {
    if (instance == null) {
      instance = new Settings1();
    }

    return instance;
  }
}
```

```java
public class App {
  public static void main(String[] args) {
    Settings1 settings = Settings1.getInstance();
    Settings1 settings1 = Settings1.getInstance();

    System.out.println(settings == settings1); // true
  }
}
```

ì´ ë°©ì‹ì˜ ì‹¬ê°í•œ ë¬¸ì œì ì€, ê·¸ ì¤‘ì—ì„œë„ ì›¹ ì•±ì„ ë§Œë“¤ë–„, ë©€í‹° ì“°ë ˆë“œë¥¼ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.

- ëŒ€ë¶€ë¶„ì˜ ì½”ë“œëŠ” ë©€í‹°ì“°ë ˆë“œ, ì¦‰, ì—¬ëŸ¬ ì“°ë ˆë“œê°€ ë™ì‹œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ì½”ë“œê°€ ëœë‹¤
- ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ì´ ì½”ë“œëŠ” ì•ˆì „í•˜ì§€ ì•Šë‹¤.

> ğŸ’¡ ë³µìŠµ
>
> 1. ìƒì„±ìë¥¼ privateìœ¼ë¡œ ë§Œë“  ì´ìœ ?
>    - ì˜¤ì§ í•œ ê°œì˜ ì¸ìŠ¤í„´ìŠ¤ì—ë§Œ ì ‘ê·¼í•˜ê¸° ìœ„í•´ ìƒì„±ìì˜ ë…¸ì¶œì„ ë§‰ê¸° ìœ„í•´ì„œ.
> 2. getInstance() ë©”ì†Œë“œë¥¼ staticìœ¼ë¡œ ì„ ì–¸í•œ ì´ìœ ?
>    - ê¸€ë¡œë²Œí•˜ê²Œ ì ‘ê·¼í•˜ê²Œ ë§Œë“¤ê¸° ìœ„í•´ static ìœ¼ë¡œ ì„ ì–¸í•˜ê³ ,
>    - ì´ëŠ” JVMì— í´ë˜ìŠ¤ ì˜ì—­ì— ìƒì„±ë˜ì–´ ê¸€ë¡œë²Œí•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
> 3. getInstance()ê°€ ë©€í‹°ì“°ë ˆë“œ í™˜ê²½ì—ì„œ ì•ˆì „í•˜ì§€ ì•Šì€ ì´ìœ ?
>    - íŠ¹íˆ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ ë•Œ ë©€í‹° ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.
>    - ë©€í‹°ì“°ë ˆë“œ í™˜ê²½ì—ì„œëŠ” ì˜¤ì§ í•œ ê°œì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ì•„ë‹ˆê²Œ ë©ë‹ˆë‹¤.
>    - ìƒˆë¡­ê²Œ ìƒì„±ëœ ì¸ìŠ¤í„´ìŠ¤ì—ì„œë„ instanceê°€ nullì¸ì§€ ì—¬ë¶€ë¥¼ íŒë‹¨í•˜ê²Œ ëœë‹¤.
>    - ì´ë•Œ ìƒˆë¡œìš´ ìŠ¤ë ˆë“œì—ëŠ” ìƒì„±ëœ instance ê°€ ì—†ê¸° ë•Œë¬¸ì— í•œ ê°œì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë³´ì¥í•  ìˆ˜ ì—†ë‹¤.

---

### 1.2 êµ¬í˜„ ë°©ë²•2-ë©€í‹° ì“°ë ˆë“œ í™˜ê²½ì—ì„œ ì•ˆì „í•˜ê²Œ êµ¬í˜„

```java
/**
 * synchronized í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•´ì„œ ë™ê¸°í™” ì²˜ë¦¬
 */
public class Settings2 {

  private static Settings2 instance;

  private Settings2() {}

  public static synchronized Settings2 getInstance() {
    if (instance == null) {
      instance = new Settings2();
    }

    return instance;
  }
}
```

`ë™ê¸°í™”(synchronized)` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•´ ë©€í‹°ì“°ë ˆë“œ í™˜ê²½ì— ì•ˆì „í•˜ê²Œ ë§Œë“œëŠ” ë°©ë²•

- ë‹¤ë§Œ ì´ ë°©ë²•ì˜ ë‹¨ì ì€ `getInstance` ë©”ì†Œë“œë¡œ í˜¸ì¶œí•  ë•Œë§ˆë‹¤,
  - ë™ê¸°í™”ì²˜ë¦¬í•˜ëŠ” ì‘ì—…ë•Œë¬¸ì— ì„±ëŠ¥ ìƒì— ì•½ê°„ì˜ ë¶ˆì´ìµì´ ìƒê¸¸ ìˆ˜ ìˆë‹¤.
- ì™œëƒí•˜ë©´ ë™ê¸°í™”ë¼ëŠ” ë©”ì»¤ë‹ˆì¦˜ ìì²´ê°€ ì–´ë–¤ ë½(ì—´ì‡ , ì ê¸ˆ)ì„ ì‚¬ìš©í•´,
  - ê·¸ ë½ì„ ê°€ì§€ê³  ìˆëŠ” ì“°ë ˆë“œë§Œ ì´ ì˜ì—­ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œë” í•´ì£¼ëŠ” ë§¤ì»¤ë‹ˆì¦˜ì´ê¸° ë–„ë¬¸ì´ë‹¤.
  - ë‹¤ ì“°ê³  ë‚˜ë©´ ê·¸ ë½ì„ í•´ì œí•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì„ ì²˜ë¦¬í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ë¶€ê°€ì ì¸ ì„±ëŠ¥ ë¶€í•˜ê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤.

> ğŸ’¡ ë³µìŠµ
>
> 1. ìë°”ì˜ ë™ê¸°í™” ë¸”ëŸ­ ì²˜ë¦¬ ë°©ë²•ì€?
>    - ì •í™•í•˜ê²ŒëŠ” ë©”ì„œë“œì— synchronizedí•˜ëŠ”ë°, ë©”ì†Œë“œ ì „ì²´ê°€ ì„ê³„ì˜ì—­ìœ¼ë¡œ ì„¤ì •ëœë‹¤.
>    - ì„ê³„ ì˜ì—­ìœ¼ë¡œ ì„¤ì •ëœ ë¶€ë¶„ì€ ì“°ë ˆë“œê°€ synchronized ë©”ì†Œë“œê°€ í˜¸ì¶œëœ ì‹œì ë¶€í„°
>    - í•´ë‹¹ ë©”ì†Œë“œê°€ í¬í•¨ëœ ê°ì²´ì˜ Lockì„ ì–»ì–´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë‹¤ê°€ ë©”ì†Œë“œê°€ ì¢…ë£Œë˜ë©´ Lockì„ ë°˜í™˜í•œë‹¤.
> 2. getInstance() ë©”ì†Œë“œ ë™ê¸°í™”ì‹œ ì‚¬ìš©í•˜ëŠ” ë½(lock)ì€ ì¸ìŠ¤í„´ìŠ¤ì˜ ë½ì¸ê°€ í´ë˜ìŠ¤ì˜ ë½ì¸ê°€? ê·¸ ì´ìœ ëŠ”?
>    - í´ë˜ìŠ¤ì˜ ë½ì´ë‹¤.
>    - ë§Œì•½ ë½ì´ ì¸ìŠ¤í„´ìŠ¤ì˜ ë½ì´ë¼ë©´, ë™ê¸°í™”ì‹œ í•˜ë‚˜ì˜ ê°ì²´ë¥¼ ë³´ì¥í•  ìˆ˜ ì—†ê²Œ ë˜ê¸° ë•Œë¬¸

---

### 1.3 êµ¬í˜„ ë°©ë²•3-ì´ë¥¸ ì´ˆê¸°í™”

ë§Œì•½ì— ì´ ê°ì²´ë¥¼ ê¼­ ë‚˜ì¤‘ì— ë§Œë“¤ì§€ ì•Šì•„ë„ ë˜ê³ , ì´ ê°ì²´ë¥¼ ë§Œë“œëŠ” ë¹„ìš©ì´ ê·¸ë ‡ê²Œ ë¹„ì‹¸ì§€ ì•Šë‹¤ë©´, ë¯¸ë¦¬ ë§Œë“¤ ìˆ˜ë„ ìˆë‹¤.

- ì´ë¥¸ ì´ˆê¸°í™”(eager initialization)ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•

```java
/**
 * ì´ë¥¸ ì´ˆê¸°í™”(eager initialization)ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•
 */
public class Settings3 {

  private static final Settings3 INSTANCE = new Settings3();

  private Settings3() { }

  public static Settings3 getInstance() {
    return INSTANCE;
  }

}
```

> ğŸ’¡ ë³µìŠµ
>
> 1. ì´ë¥¸ ì´ˆê¸°í™”ê°€ ë‹¨ì ì´ ë  ìˆ˜ë„ ìˆëŠ” ì´ìœ ?
>    - ë¯¸ë¦¬ ë§Œë“¤ê²Œ ë˜ëŠ” ê²ƒì´ ë‹¨ì ì´ ë  ìˆ˜ ìˆëŠ”ë°, ë§Œì•½ ìƒì„±ìì— ë§ì€ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©ë˜ëŠ” ê²½ìš°ì—ëŠ” ì¢‹ì§€ ì•Šë‹¤.
> 2. ë§Œì•½ì— ìƒì„±ìì—ì„œ checked ì˜ˆì™¸ë¥¼ ë˜ì§„ë‹¤ë©´ ì´ ì½”ë“œë¥¼ ì–´ë–»ê²Œ ë³€ê²½í•´ì•¼ í• ê¹Œìš”?
>    - ë§Œì•½ ìƒì„±ìì—ì„œ ì˜ˆì™¸ë¥¼ ë˜ì§„ë‹¤ë©´,
>    - ê·¸ ì•ˆì—ì„œ try-catch ìœ¼ë¡œ ì˜ˆì™¸ í•¸ë“¤ë§ì„ í•´ì•¼ë§Œ í•œë‹¤. ê·¸ë ‡ì§€ ì•Šë‹¤ë©´, ì´ë¥¸ ì´ˆê¸°í™”ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.

---

### 1.4 êµ¬í˜„ ë°©ë²•4-double checked locking

```java
package me.whiteship.designpatterns._01_creational_patterns._01_singleton;

/**
 * double checked locking
 */
public class Settings4 {

  private static volatile Settings4 instance;

  private Settings4() {
  }

  public static Settings4 getInstance() {
    if (instance == null) {
      synchronized (Settings4.class) {
        if (instance == null) {
          instance = new Settings4();
        }
      }
    }

    return instance;
  }

}
```

- `double checked locking`ìœ¼ë¡œ íš¨ìœ¨ì ì¸ ë™ê¸°í™” ë¸”ëŸ­ ë§Œë“¤ê¸°
- java 1.5 ì´ìƒì—ì„œ ë™ì‘

> ğŸ’¡ ë³µìŠµ
>
> 1. `double check locking`ì´ë¼ê³  ë¶€ë¥´ëŠ” ì´ìœ ?
>    - 2ë²ˆì— ê±¸ì³ ë‹¨ í•˜ë‚˜ì˜ ê°ì²´ì„ì„ ì²´í¬í•˜ê¸° ë•Œë¬¸ì´ë‹¤.
>    - if ë¬¸ì´ 2ë²ˆ ì‚¬ìš©ë˜ëŠ”ë°, ì²«ë²ˆì§¸ëŠ” instanceê°€ nullì¼ ê²½ìš°ì™€,
>      - ë™ê¸°í™” í´ë˜ìŠ¤ synchronized(xx.class) ì—ì„œ í•œë²ˆ ë” ì²´í¬í•˜ê¸° ë•Œë¬¸ì´ë‹¤.
>    - ë™ê¸°í™” ë§¤ì»¤ë‹ˆì¦˜ì„ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
>    - ë§Œì•½ instanceê°€ ìˆë‹¤ë©´ ë°”ë¡œ ë¦¬í„´í•˜ê¸° ë•Œë¬¸ì´ë‹¤.
> 2. `instacne` ë³€ìˆ˜ëŠ” ì–´ë–»ê²Œ ì •ì˜í•´ì•¼ í•˜ëŠ”ê°€? ê·¸ ì´ìœ ëŠ”?
>    - `volatile`ì„ ì‚¬ìš©í•˜ì—¬, ê°€ì¥ ìµœì‹ ì˜ ê°ì²´ë¥¼ ê°€ì ¸ì˜¤ë„ë¡ í•œë‹¤.
>    - Multi Thread í™˜ê²½ì—ì„œ í•˜ë‚˜ì˜ Threadë§Œ read & writeí•˜ê³ ,
>    - ë‚˜ë¨¸ì§€ Threadê°€ readí•˜ëŠ” ìƒí™©ì—ì„œ ê°€ì¥ ìµœì‹ ì˜ ê°’ì„ ë³´ì¥í•œë‹¤.

---

### 1.5 êµ¬í˜„ ë°©ë²•5-static inner í´ë˜ìŠ¤ ì‚¬ìš© (ê¶Œì¥)

```java
package me.whiteship.designpatterns._01_creational_patterns._01_singleton;

/**
 * static inner í´ë˜ìŠ¤ í™€ë”
 */
public class Settings5 {

  private Settings5() {
  }

  private static class Settings5Holder {
    private static final Settings5 INSTANCE = new Settings5();
  }

  public static Settings5 getInstance() {
    return Settings5Holder.INSTANCE;
  }

}
```

- ê¶Œì¥í•˜ëŠ” ë°©ë²•ì¤‘ í•˜ë‚˜.
- ì´ ë°©ë²•ì€ static final ë¥¼ ì»ëŠ”ë°ë„, ì™œ `ì§€ì—° ì´ˆê¸°í™”(lazy intialization)`ë¼ê³  ë³¼ ìˆ˜ ìˆëŠ”ê°€?
  - Holderë¥¼ í†µí•´ ê°ì²´ë¥¼ ìƒì„±í•˜ê²Œ ë˜ëŠ”ë°,
  - ì´ë ‡ê²Œ í•  ê²½ìš° `getIntance()`ê°€ í˜¸ì¶œë  ë•Œ ë¡œë”©ë˜ê¸° ë•Œë¬¸ì´ë‹¤.

---

### 1.6 ì‹±ê¸€í†¤ êµ¬í˜„ ê¹¨íŠ¸ë¦¬ëŠ” ë°©ë²•1

```java
public class App {

  public static void main(String[] args) throws IOException, ClassNotFoundException {
    Settings settings = Settings.getInstance();

    Constructor<Settings> declaredConstructor = Settings.class.getDeclaredConstructor();
    declaredConstructor.setAccessible(true);
    Settings settings1 = declaredConstructor.newInstance();

    System.out.println(settings == settings1); // false
  }

}
```

> ğŸ’¡ ë³µìŠµ
>
> 1. ë¦¬í”Œë ‰ì…˜ì— ëŒ€í•´ ì„¤ëª…í•˜ì„¸ìš”.
>    - êµ¬ì²´ì ì¸ í´ë˜ìŠ¤ íƒ€ì…ì„ ì•Œì§€ ëª»í•´ë„,
>    - ê·¸ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œ, íƒ€ì…, ë³€ìˆ˜ë“¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ìë°” API
> 2. `setAccessible(true)`ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ”?
>    - private ìƒì„±ìì— ì ‘ê·¼í•˜ê¸° ìœ„í•œ ëª©ì ì´ë‹¤.

---

### 1.7 ì‹±ê¸€í†¤ êµ¬í˜„ ê¹¨íŠ¸ë¦¬ëŠ” ë°©ë²•2

```java
public class App {

  public static void main(String[] args) throws IOException, ClassNotFoundException {
    Settings5 settings = Settings5.INSTANCE;

    Settings5 settings1 = null;
    try (ObjectOutput out = new ObjectOutputStream(new FileOutputStream("settings.obj"))) {
      out.writeObject(settings);
    }

    try (ObjectInput in = new ObjectInputStream(new FileInputStream("settings.obj"))) {
      settings1 = (Settings5) in.readObject();
    }

    System.out.println(settings == settings1);
  }

}
```

> ğŸ’¡ ë³µìŠµ
>
> 1. ìë°”ì˜ ì§ë ¬í™” & ì—­ì§ë ¬í™”ì— ëŒ€í•´ ì„¤ëª…í•˜ì„¸ìš”.
>    - ì§ë ¬í™”: ìë°” ì‹œìŠ¤í…œ ë‚´ë¶€ì—ì„œ ì‚¬ìš©ë˜ëŠ” ê°ì²´ ë˜ëŠ” ë°ì´í„°ë¥¼ ë°”ì´íŠ¸(byte) í˜•íƒœë¡œ ë³€í™˜
>    - ì—­ì§ë ¬í™”: ë°”ì´íŠ¸ë¡œ ë³€í™˜ëœ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ê°ì²´ë¡œ ë³€í™˜
> 2. SerializableIdë€ ë¬´ì—‡ì´ë©° ì™œ ì“°ëŠ”ê°€?
>    - ì§ë ¬í™”ëœ í´ë˜ìŠ¤ì˜ ë²„ì „ì„ ê¸°ì–µí•˜ì—¬ ë¡œë“œëœ í´ë˜ìŠ¤ì™€ ì§ë ¬í™”ëœ ê°ì²´ê°€ í˜¸í™˜ë˜ëŠ”ì§€ í™•ì¸í•œë‹¤.
>    - SerializableIdê°€ ë‹¤ë¥´ë©´ ì—­ì§ë ¬í™” í•  ìˆ˜ ì—†ë‹¤.
> 3. try-resource ë¸”ëŸ­ì— ëŒ€í•´ ì„¤ëª…í•˜ì„¸ìš”
>    - try ì½”ë“œ ë¸”ëŸ­ì´ ëë‚˜ë©´ ìë™ìœ¼ë¡œ ìì›ì„ ì¢…ë£Œí•´ì£¼ê¸° ë•Œë¬¸ì— ëª…ì‹œì ìœ¼ë¡œ ìì› ë°˜í™˜ì„ í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.

---

### 1.8 êµ¬í˜„ ë°©ë²•6-enum (ê¶Œì¥)

```java
/**
 * Enumì„ ì‚¬ìš©í•´ì„œ ì‹±ê¸€í†¤ ë§Œë“¤ê¸°
 */
public enum Settings5 {
  INSTANCE,
}
```

1. enum íƒ€ì…ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë¦¬íŒ©í† ë§ì„ ë§Œë“¤ ìˆ˜ ìˆëŠ”ê°€?
   - ë§Œë“¤ ìˆ˜ ì—†ë‹¤.
   - enum íƒ€ì…ì˜ í´ë˜ìŠ¤ëŠ” ë¦¬í”Œë™ì…˜ì„ í†µí•´ ë§Œë“¤ ìˆ˜ ì—†ë„ë¡ ì œí•œí•œë‹¤.
2. enumìœ¼ë¡œ ì‹±ê¸€í†¤ íƒ€ì…ì„ êµ¬í˜„í•  ë•Œì˜ ë‹¨ì ì€?
   - ë‹¨ì ì€ ì´ë¥¸ ì´ˆê¸°í™”ì™€ ê°™ì´ ë¯¸ë¦¬ ë§Œë“¤ì–´ì§„ë‹¤ëŠ” ê²ƒì´ë‹¤.
   - ê·¸ë¦¬ê³  ìƒì†ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.
3. ì§ë ¬í™” & ì—­ì§ë ¬í™” ì‹œì— ë³„ë„ë¡œ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ë©”ì†Œë“œê°€ ìˆëŠ”ê°€?
   - ë³„ë‹¤ë¥¸ ì¥ì¹˜ê°€ ì—†ì–´ë„ Enum í´ë˜ìŠ¤ëŠ” ì§ë ¬í™” & ì—­ì§ë ¬í™”ê°€ ëœë‹¤.
   - ê·¸ëŸ¬ë‚˜ getResolves() êµ¬í˜„ì‹œ ì—­ì§ë ¬í™”ì‹œ ë³€ê²½ì„ ê°€í•  ìˆ˜ ìˆë‹¤.

---

### 1.9 ì‹¤ë¬´ì—ì„œëŠ” ì–´ë–»ê²Œ ì“°ì´ë‚˜?

- ìŠ¤í”„ë§ì—ì„œ ë¹ˆì˜ ìŠ¤ì½”í”„ ì¤‘ì— í•˜ë‚˜ë¡œ ì‹±ê¸€í†¤ ìŠ¤ì½”í”„.
- ìë°” java.lang.Runtime
- ë‹¤ë¥¸ ë””ìì¸ íŒ¨í„´(ë¹Œë”, í¼ì‚¬ë“œ, ì¶”ìƒ íŒ©í† ë¦¬ ë“±) êµ¬í˜„ì²´ì˜ ì¼ë¶€ë¡œ ì“°ì´ê¸°ë„ í•œë‹¤.

---

## 2. íŒ©í† ë¦¬ ë©”ì„œë“œ(Factory method) íŒ¨í„´

![gof_1_2](https://raw.githubusercontent.com/berenickt/image-server/main/img/gof_1_2.png)

êµ¬ì²´ì ìœ¼ë¡œ **ì–´ë–¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ì§€ëŠ” ì„œë¸Œ í´ë˜ìŠ¤ê°€ ì •í•œë‹¤.**

- ë‹¤ì–‘í•œ êµ¬í˜„ì²´(Product)ê°€ ìˆê³ ,
  - ê·¸ ì¤‘ì—ì„œ íŠ¹ì •í•œ êµ¬í˜„ì²´ë¥¼ ë§Œë“¤ ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ íŒ©í† ë¦¬ (Creator)ë¥¼ ì œê³µí•  ìˆ˜ ìˆë‹¤.
- e.g. ì–´ë–¤ ë°°ë¥¼ ë§Œë“ ë‹¤ê³  ê°€ì •í•´ë³´ë©´,
  - í•˜ì–€ ë°°ë¥¼ ë§Œë“œëŠ” ê³µì¥ì—ëŠ” í•˜ì–€ë°°ë§Œ ë§Œë“¤ë‹¤ê°€,
  - ì‚¬ì—…ì´ ì˜ë˜ì„œ ì¶”í›„ì— ê²€ì • ë°°ë¥¼ ë§Œë“œëŠ” ê³µì¥ë„ ë§Œë“¤ì—ˆë‹¤.
  - ìƒ‰ ì¹ í•˜ëŠ” ì‘ì—…, ë¡œê³ ë¥¼ ìƒˆê¸°ê³ , ë‹¤ ë§Œë“¤ë©´ ì•Œë¦¼ì„ ìš¸ë¦¬ëŠ” ë“±ì˜ ì²˜ë¦¬ í”„ë¡œì„¸ìŠ¤ê°€ ìˆì„ ê²ƒì´ë‹¤.
  - ì´ ê³¼ì •ì„ í•œ ë¡œì§ì— ë‹´ì•„ë‘ë©´ ë³µì¡í•´ì§ˆ ê²ƒì´ë‹¤.
  - ê·¸ë˜ì„œ ê°œë³„ ê³¼ì •ì´ ë‹´ê¸´ ì¶”ìƒí™”ë˜ì–´ ìˆëŠ” ê³µì¥ì„ ë§Œë“ ë‹¤.
- How? ìœ„ ê·¸ë¦¼ì²˜ëŸ¼ ê³µì¥(factory) ì—­í• ì„ í•  ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ê³ ,
  - ì´ `ì¸í„°í˜ì´ìŠ¤ì— ì •ì˜ë˜ì–´ ìˆëŠ” ë©”ì†Œë“œ`ëŠ” ì—¬ëŸ¬ ê°œê°€ ìˆì„ ìˆ˜ ìˆë‹¤.
  - ì´ êµ¬í˜„ë¶€ ì¤‘ì— ì¼ë¶€ ë°”ë€Œì–´ì•¼ ë˜ëŠ” ê²ƒë“¤ì„ `ì¶”ìƒ ë©”ì„œë“œ`ë¡œ ë¹¼ë‚´ì„œ **í•˜ìœ„ í´ë˜ìŠ¤ì—ì„œ ë§Œë“¤ê²Œë”** í•œë‹¤.
  - ì´ íŒ©í† ë¦¬ì—ì„œ ë§Œë“¤ì–´ë‚¸ ë‹¤ì–‘í•œ ê°ì²´ë¥¼ ë§Œë“¤ ìˆ˜ ìˆê²Œë” Productë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ê³ ,
  - ê·¸ ê°ê°ì˜ êµ¬ì²´ì ì¸ íŒ©í† ë¦¬ ì•ˆì—ì„œ êµ¬ì²´ì ì¸ ì¸ìŠ¤í„´ìŠ¤ë“¤ì„ ë§Œë“¤ê²Œë” ì„¤ê³„í•˜ë©´,
  - ìœ ì—°í•œ í™•ì¥ì— ìš©ì´í•œ êµ¬ì¡°ê°€ ëœë‹¤.
- cf. factoryëŠ” 'ê³µì¥'ì´ë€ ëœ»ì´ê³ , ê³µì¥ì€ ë¬¼ê±´ì„ ë§Œë“œëŠ” ê³³ì´ë‹¤. ì—¬ê¸°ì„œ ë¬¼ê±´ì— í•´ë‹¹ë˜ëŠ” ê²ƒì´ ë°”ë¡œ ì¸ìŠ¤í„´ìŠ¤ì´ë‹¤

---

### 2.1 êµ¬í˜„ ë°©ë²•

![gof_1_3](https://raw.githubusercontent.com/berenickt/image-server/main/img/gof_1_3.png)

`íŒ©í† ë¦¬ ë©”ì†Œë“œ êµ¬í˜„ ë°©ë²•` : **í™•ì¥ì— ì—´ë ¤ìˆê³  ë³€ê²½ì— ë‹«í˜€ìˆëŠ” êµ¬ì¡°**ë¡œ ë§Œë“¤ì–´ë³´ì

---

### 2.2 ì˜ˆì‹œ - ê¸°ì¡´

```java
// Ship.java
package me.whiteship.designpatterns._01_creational_patterns._02_factory_method._01_before;

public class Ship {

    private String name;

    private String color;

    private String logo;

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getColor() {
        return color;
    }

    public void setColor(String color) {
        this.color = color;
    }

    public String getLogo() {
        return logo;
    }

    public void setLogo(String logo) {
        this.logo = logo;
    }

    @Override
    public String toString() {
        return "Ship{" + "name='" + name + '\'' + ", color='" + color + '\'' + ", logo='" + logo + '\'' + '}';
    }
}
```

```java
// ShipFactory.java
package me.whiteship.designpatterns._01_creational_patterns._02_factory_method._01_before;

public class ShipFactory {

  public static Ship orderShip(String name, String email) {
    // validate
    if (name == null || name.isBlank()) {
      throw new IllegalArgumentException("ë°° ì´ë¦„ì„ ì§€ì–´ì£¼ì„¸ìš”.");
    }
    if (email == null || email.isBlank()) {
      throw new IllegalArgumentException("ì—°ë½ì²˜ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”.");
    }

    prepareFor(name);

    Ship ship = new Ship();
    ship.setName(name);

    // Customizing for specific name
    if (name.equalsIgnoreCase("whiteship")) {
      ship.setLogo("\uD83D\uDEE5ï¸");
    } else if (name.equalsIgnoreCase("blackship")) {
      ship.setLogo("âš“");
    }

    // coloring
    if (name.equalsIgnoreCase("whiteship")) {
      ship.setColor("whiteship");
    } else if (name.equalsIgnoreCase("blackship")) {
      ship.setColor("black");
    }

    // notify
    sendEmailTo(email, ship);

    return ship;
  }

  private static void prepareFor(String name) {
    System.out.println(name + " ë§Œë“¤ ì¤€ë¹„ ì¤‘");
  }

  private static void sendEmailTo(String email, Ship ship) {
    System.out.println(ship.getName() + " ë‹¤ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.");
  }
}

```

```java
// Client.java
package me.whiteship.designpatterns._01_creational_patterns._02_factory_method._01_before;

public class Client {

  public static void main(String[] args) {
    Ship whiteship = ShipFactory.orderShip("Whiteship", "keesun@mail.com");
    System.out.println(whiteship);

    Ship blackship = ShipFactory.orderShip("Blackship", "keesun@mail.com");
    System.out.println(blackship);
  }
}
```

---

### 2.3 ì˜ˆì‹œ - ë³€ê²½

```java
// ShipFactory.java
package me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after;

public interface ShipFactory {
  default Ship orderShip(String name, String email) {
    validate(name, email);
    prepareFor(name);
    Ship ship = createShip();
    sendEmailTo(email, ship);
    return ship;
  }

  void sendEmailTo(String email, Ship ship);

  Ship createShip();

  private void validate(String name, String email) {
    if (name == null || name.isBlank()) {
      throw new IllegalArgumentException("ë°° ì´ë¦„ì„ ì§€ì–´ì£¼ì„¸ìš”.");
    }
    if (email == null || email.isBlank()) {
      throw new IllegalArgumentException("ì—°ë½ì²˜ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”.");
    }
  }

  private void prepareFor(String name) {
    System.out.println(name + " ë§Œë“¤ ì¤€ë¹„ ì¤‘");
  }
}
```

```java
// DefaultShipFactory.java
package me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after;

public abstract class DefaultShipFactory implements ShipFactory {

  @Override
  public void sendEmailTo(String email, Ship ship) {
    System.out.println(ship.getName() + " ë‹¤ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.");
  }
}
```

```java
// WhiteshipFactory.java
package me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after;

public class WhiteshipFactory extends DefaultShipFactory {

  @Override
  public Ship createShip() {
    return new Whiteship();
  }
}
```

```java
// Ship.java
package me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after;

import me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._02_after.Anchor;
import me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._02_after.Wheel;

public class Ship {

  private String name;

  private String color;

  private String logo;

  private Wheel wheel;

  private Anchor anchor;

  public String getName() {
    return name;
  }

  public void setName(String name) {
    this.name = name;
  }

  public String getColor() {
    return color;
  }

  public void setColor(String color) {
    this.color = color;
  }

  public String getLogo() {
    return logo;
  }

  public void setLogo(String logo) {
    this.logo = logo;
  }

  @Override
  public String toString() {
    return (
      "Ship{" + "name='" + name +
      '\'' + ", color='" + color +
      '\'' + ", logo='" + logo + '\'' +
      '}'
    );
  }

  public Wheel getWheel() {
    return wheel;
  }

  public void setWheel(Wheel wheel) {
    this.wheel = wheel;
  }

  public Anchor getAnchor() {
    return anchor;
  }

  public void setAnchor(Anchor anchor) {
    this.anchor = anchor;
  }
}
```

```java
// Whiteship.java
package me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after;

public class Whiteship extends Ship {

  public Whiteship() {
    setName("whiteship");
    setLogo("\uD83D\uDEE5");
    setColor("white");
  }
}
```

```java
// BlackshipFactory.java
package me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after;

public class BlackshipFactory extends DefaultShipFactory {

  @Override
  public Ship createShip() {
    return new Blackship();
  }
}
```

```java
// Blackship.java
package me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after;

public class Blackship extends Ship {

  public Blackship() {
    setName("blackship");
    setColor("black");
    setLogo("âš“");
  }
}
```

```java
// Client.java
package me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after;

public class Client {

  public static void main(String[] args) {
    Client client = new Client();
    client.print(new WhiteshipFactory(), "whiteship", "keesun@mail.com");
    client.print(new BlackshipFactory(), "blackship", "keesun@mail.com");
  }

  private void print(ShipFactory shipFactory, String name, String email) {
    System.out.println(shipFactory.orderShip(name, email));
  }
}
```

---

### 2.4 ì •ë¦¬ ë° ì¥ë‹¨ì 

êµ¬ì²´ì ìœ¼ë¡œ ì–´ë–¤ ê²ƒì„ ë§Œë“¤ì§€ëŠ” ì„œë¸Œ í´ë˜ìŠ¤ê°€ ì •í•œë‹¤.

- íŒ©í† ë¦¬ ë©”ì†Œë“œ íŒ¨í„´ì„ ì ìš©í–ˆì„ ë•Œì˜ ì¥ì ì€? ë‹¨ì ì€?
  - `ì¥ì ` : **í™•ì¥ì— ì—´ë ¤ìˆê³  ë³€ê²½ì— ë‹«í˜€ìˆëŠ” ê°ì²´ ì§€í–¥ ì›ì¹™ì„ ì ìš©**í•´ì„œ,
    - ê¸°ì¡´ ì½”ë“œë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³ , ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ í™•ì¥ì´ ê°€ëŠ¥í•˜ë‹¤
  - `ë‹¨ì ` : í´ë˜ìŠ¤ê°€ ë§ì•„ ì§„ë‹¤.
- â€œí™•ì¥ì— ì—´ë ¤ìˆê³  ë³€ê²½ì— ë‹«í˜€ìˆëŠ” ê°ì²´ ì§€í–¥ ì›ì¹™â€ì„ ì„¤ëª…í•˜ì„¸ìš”.
  - **ê¸°ì¡´ ì½”ë“œë¥¼ ë³€ê²½í•˜ì§€ ì•Šìœ¼ë©´ì„œ, ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ í™•ì¥í•  ìˆ˜ ìˆëŠ” êµ¬ì¡°**ë¥¼ ë§Œë“œëŠ” ê²ƒ
- ìë°” 8ì— ì¶”ê°€ëœ default ë©”ì†Œë“œì— ëŒ€í•´ ì„¤ëª…í•˜ì„¸ìš”.
  - ì¸í„°í˜ì´ìŠ¤ì—ì„œ ê¸°ë³¸ì ì¸ êµ¬í˜„ì²´ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
  - ì˜¤íˆë ¤ ì¶”ìƒ í´ë˜ìŠ¤ì—ì„œ í•˜ë˜ ì¼ì„ ì¸í„°í˜ì´ìŠ¤ì—ì„œë„ í•  ìˆ˜ ìˆê²Œë” ë˜ì—ˆê¸° ë•Œë¬¸ì—
    - Java 8ë¶€í„°ëŠ” ì¶”ìƒ í´ë˜ìŠ¤ë¥¼ ê·¸ë ‡ê²Œ ë§ì´ ì“°ì§€ëŠ” ì•ŠëŠ”ë‹¤.
  - ì •ë§ ì¶”ìƒ í´ë˜ìŠ¤ê°€ í•„ìš”í•œ ê²½ìš°ê°€ ì•„ë‹ˆë¼ë©´, ì¸í„°í˜ì´ìŠ¤ì— ìˆëŠ” defaut ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì„œ ì‹œë„í•´ë³´ê¸¸ ë°”ë€ë‹¤.
  - ë‚˜ì•„ê°€ Java 9ì—ì„œëŠ” ì¸í„°í˜ì´ìŠ¤ì— private ë©”ì†Œë“œë¥¼ ì •ì˜í•˜ëŠ” ê²ƒë„ ìˆë‹¤.

---

### 2.5 ì‹¤ë¬´ì—ì„œëŠ” ì–´ë–»ê²Œ ì“°ì´ë‚˜?

ë‹¨ìˆœí•œ íŒ©í† ë¦¬ íŒ¨í„´

- ë§¤ê°œë³€ìˆ˜ì˜ ê°’ì— ë”°ë¼ ë˜ëŠ” ë©”ì†Œë“œì— ë”°ë¼ ê°ê¸° ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë¦¬í„´í•˜ëŠ” ë‹¨ìˆœí•œ ë²„ì „ì˜ íŒ©í† ë¦¬ íŒ¨í„´
- `java.lang.Calendar` ë˜ëŠ” `java.lang.NumberFormat`

```java
package me.whiteship.designpatterns._01_creational_patterns._02_factory_method._03_java;

import me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after.Blackship;
import me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after.Whiteship;

public class SimpleFactory {

  public Object createProduct(String name) {
    if (name.equals("whiteship")) {
      return new Whiteship();
    } else if (name.equals("blackship")) {
      return new Blackship();
    }

    throw new IllegalArgumentException();
  }
}
```

```java
package me.whiteship.designpatterns._01_creational_patterns._02_factory_method._03_java;

import java.util.Calendar;
import java.util.Locale;

public class CalendarExample {

  public static void main(String[] args) {
    System.out.println(Calendar.getInstance().getClass()); // ê·¸ë ˆê³ ë¦¬ë ¥ ë‹¬ë ¥
    System.out.println(
      Calendar
        .getInstance(Locale.forLanguageTag("th-TH-x-lvariant-TH"))
        .getClass()
    ); // íƒ€ì´ì™„ ë‹¬ë ¥
    System.out.println(
      Calendar
        .getInstance(Locale.forLanguageTag("ja-JP-x-lvariant-JP"))
        .getClass()
    ); // ì¼ë³¸ ë‹¬ë ¥
  }
}
```

ìŠ¤í”„ë§ BeanFactory

- Object íƒ€ì…ì˜ Productë¥¼ ë§Œë“œëŠ” BeanFacotryë¼ëŠ” Creator!

```java
package me.whiteship.designpatterns._01_creational_patterns._02_factory_method._03_java;

import org.springframework.beans.factory.BeanFactory;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class SpringBeanFactoryExample {

  public static void main(String[] args) {
    BeanFactory xmlFactory = new ClassPathXmlApplicationContext("config.xml");
    String hello = xmlFactory.getBean("hello", String.class);
    System.out.println(hello);

    BeanFactory javaFactory = new AnnotationConfigApplicationContext(
      Config.class
    );
    String hi = javaFactory.getBean("hello", String.class);
    System.out.println(hi);
  }
}
```

---

## 3. ì¶”ìƒ íŒ©í† ë¦¬(Abstract factory) íŒ¨í„´

![gof_1_4](https://raw.githubusercontent.com/berenickt/image-server/main/img/gof_1_4.png)

**ì„œë¡œ ê´€ë ¨ìˆëŠ” ì—¬ëŸ¬ ê°ì²´(=ì¸ìŠ¤í„´ìŠ¤)ë¥¼ ë§Œë“¤ì–´ì£¼ëŠ” ì¸í„°í˜ì´ìŠ¤**.

- êµ¬ì²´ì ìœ¼ë¡œ ì–´ë–¤ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼(concrete product)ë¥¼ ì‚¬ìš©í•˜ëŠ”ì§€ ê°ì¶œ ìˆ˜ ìˆë‹¤.
- ì¸í„°í˜ì´ìŠ¤ë¡œ ì •ì˜í•˜ê±°ë‚˜, ì¶”ìƒ í´ë˜ìŠ¤ë¡œ ì •ì˜í•˜ê±°ë‚˜ ê·¸ë˜ì„œ êµ¬ì²´ì ì¸ Factoryë¥¼ ë§Œë“œëŠ” ê²ƒê¹Œì§€ëŠ” íŒ©í† ë¦¬ ë©”ì„œë“œì™€ ë¹„ìŠ·í•˜ì§€ë§Œ,

  - ì´ˆì ì´ í´ë¼ì´ì–¸íŠ¸ìª½ì— ìˆë‹¤.
  - **Factoryë¥¼ ì‚¬ìš©í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ ìª½ì— ì´ˆì **ì„ ë°”ë¼ë³´ë©´ `ì¶”ìƒ íŒ©í† ë¦¬ íŒ¨í„´`ì´ë‹¤.
  - ë°˜ëŒ€ë¡œ **Factoryìª½ì—ë§Œ ì´ˆì **ìœ¼ë¡œ ë°”ë¼ë³´ë©´ `íŒ©í† ë¦¬ ë©”ì„œë“œ íŒ¨í„´`ì´ë‹¤.

- íŒ©í† ë¦¬ ë©”ì†Œë“œì˜ ëª©ì  ìì²´ê°€ **í´ë¼ì´ì–¸íŠ¸ì˜ ì½”ë“œë¥¼ ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ìœ¼ë¡œ ì½”ë”©í•˜ëŠ” ê²ƒ**ì— ìˆë‹¤.
- ìœ„ ê·¸ë¦¼ì€ `íŒ©í† ë¦¬ ë©”ì„œë“œ íŒ¨í„´`ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë§Œ ì¶”ê°€ëœ ê²ƒì¼ ë¿ì´ë‹¤.

  - ë‚´ë¶€ êµ¬ì¡°ëŠ” `íŒ©í† ë¦¬ ë©”ì„œë“œ íŒ¨í„´`ê³¼ êµ‰ì¥íˆ ìœ ì‚¬í•˜ë‹¤.

- e.g. í•˜ì–€ ë°°ì™€ ê²€ì • ë°°ë¥¼ ë§Œë“œëŠ”ë°, ë¹„ìŠ·í•œ ë¶€í’ˆë“¤ì´ ì„¸íŠ¸ë¡œ ìˆì„ ê²ƒì´ë‹¤. (e.g. ë‹»ì´ë‚˜ ë°°ì˜ ë°”í€´)
  - ê·¸ëŸ¬ë‹¤ ë°œì „ëœ ë¶€í’ˆì´ ìƒˆë¡œ ë‚˜ì™”ë‹¤ë©´, í•´ë‹¹ ì œí’ˆì— ëª¨ë‘ ë‹¤ ë°”ê¿”ì¤˜ì•¼ ë  ê²ƒì´ë‹¤.
  - ì´ë ‡ê²Œ ëª¨ë‘ ë°”ë€ŒëŠ” ê²ƒì„ ë°”ë€Œì§€ ì•Šê²Œë” í•˜ë©´ì„œ ì œí’ˆêµ°ì„ ëŠ˜ë ¤ë‚˜ê°ˆ ìˆ˜ ìˆëŠ” ë°©ë²•ìœ¼ë¡œ ì¶”ìƒ íŒ©í† ë¦¬ë¥¼ ì ìš©í•´ë³¸ë‹¤.

---

### 3.1 êµ¬í˜„ ë°©ë²•

![gof_1_5](https://raw.githubusercontent.com/berenickt/image-server/main/img/gof_1_5.png)

`í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ`ì—ì„œ **êµ¬ì²´ì ì¸ í´ë˜ìŠ¤ì˜ ì˜ì¡´ì„±ì„ ì œê±°**í•œë‹¤.

---

### 3.2 ì˜ˆì‹œ - ê¸°ì¡´

```java
// Anchor.java
package me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._02_after;

public interface Anchor {}
```

```java
// WhiteAnchor.java
package me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._01_before;

import me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._02_after.Anchor;

public class WhiteAnchor implements Anchor {}
```

```java
// Wheel.java
package me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._02_after;

public interface Wheel {}
```

```java
// WhiteWheel.java
package me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._01_before;

import me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._02_after.Wheel;

public class WhiteWheel implements Wheel {}
```

```java
// WhiteshipFactory.java
package me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._01_before;

import me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after.DefaultShipFactory;
import me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after.Ship;
import me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after.Whiteship;

public class WhiteshipFactory extends DefaultShipFactory {

  @Override
  public Ship createShip() {
    Ship ship = new Whiteship();
    ship.setAnchor(new WhiteAnchor());
    ship.setWheel(new WhiteWheel());
    return ship;
  }
}
```

---

### 3.3 ì˜ˆì‹œ - ë³€ê²½

```java
// WhiteAnchorPro.java
package me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._02_after;

public class WhiteAnchorPro implements Anchor {}
```

```java
// WhiteWheelPro.java
package me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._02_after;

public class WhiteWheelPro implements Wheel {}
```

```java
// ShipPartsFactory.java
package me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._02_after;

import me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._01_before.WhiteAnchor;
import me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._01_before.WhiteWheel;

public class WhiteshipPartsFactory implements ShipPartsFactory {

  @Override
  public Anchor createAnchor() {
    return new WhiteAnchor();
  }

  @Override
  public Wheel createWheel() {
    return new WhiteWheel();
  }
}
```

```java
// WhiteshipPartsFactory.java
package me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._02_after;

public class WhitePartsProFactory implements ShipPartsFactory {

  @Override
  public Anchor createAnchor() {
    return new WhiteAnchorPro();
  }

  @Override
  public Wheel createWheel() {
    return new WhiteWheelPro();
  }
}
```

```java
// WhiteshipFactory.java
package me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._02_after;

import me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after.DefaultShipFactory;
import me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after.Ship;
import me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after.Whiteship;

public class WhiteshipFactory extends DefaultShipFactory {

  private ShipPartsFactory shipPartsFactory;

  public WhiteshipFactory(ShipPartsFactory shipPartsFactory) {
    this.shipPartsFactory = shipPartsFactory;
  }

  @Override
  public Ship createShip() {
    Ship ship = new Whiteship();
    ship.setAnchor(shipPartsFactory.createAnchor());
    ship.setWheel(shipPartsFactory.createWheel());
    return ship;
  }
}
```

```java
// ShipInventory.java
package me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._02_after;

import me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after.Ship;
import me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after.ShipFactory;

public class ShipInventory {

  public static void main(String[] args) {
    ShipFactory shipFactory = new WhiteshipFactory(new WhiteshipPartsFactory());
    Ship ship = shipFactory.createShip();
    System.out.println(ship.getAnchor().getClass());
    System.out.println(ship.getWheel().getClass());
  }
}
```

---

### 3.4 ì •ë¦¬

íŒ©í† ë¦¬ ë©”ì†Œë“œ íŒ¨í„´ê³¼ êµ‰ì¥íˆ í¡ì‚¬í•œë° ë¬´ì—‡ì´ ë‹¤ë¥¸ê±´ê°€.

- ëª¨ì–‘ê³¼ íš¨ê³¼ëŠ” ë¹„ìŠ·í•˜ì§€ë§Œâ€¦
  - ë‘˜ ë‹¤ êµ¬ì²´ì ì¸ ê°ì²´ ìƒì„± ê³¼ì •ì„ `ì¶”ìƒí™”í•œ ì¸í„°í˜ì´ìŠ¤`ë¥¼ ì œê³µí•œë‹¤.
- ê´€ì ì´ ë‹¤ë¥´ë‹¤.
  - `íŒ©í† ë¦¬ ë©”ì†Œë“œ íŒ¨í„´`ì€ `íŒ©í† ë¦¬ë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ë²•(inheritance)`ì— ì´ˆì ì„ ë‘”ë‹¤.
  - `ì¶”ìƒ íŒ©í† ë¦¬ íŒ¨í„´`ì€ `íŒ©í† ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•(composition)`ì— ì´ˆì ì„ ë‘”ë‹¤.
- ëª©ì ì´ ì¡°ê¸ˆ ë‹¤ë¥´ë‹¤.
  - `íŒ©í† ë¦¬ ë©”ì†Œë“œ íŒ¨í„´`ì€ êµ¬ì²´ì ì¸ **ê°ì²´ ìƒì„± ê³¼ì •ì„ í•˜ìœ„ ë˜ëŠ” êµ¬ì²´ì ì¸ í´ë˜ìŠ¤ë¡œ ì˜®ê¸°ëŠ” ê²ƒì´ ëª©ì **.
  - `ì¶”ìƒ íŒ©í† ë¦¬ íŒ¨í„´`ì€ ê´€ë ¨ìˆëŠ” **ì—¬ëŸ¬ ê°ì²´ë¥¼ êµ¬ì²´ì ì¸ í´ë˜ìŠ¤ì— ì˜ì¡´í•˜ì§€ ì•Šê³  ë§Œë“¤ ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê²ƒì´ ëª©ì **

---

### 3.5 ì‹¤ë¬´ì—ì„œëŠ” ì–´ë–»ê²Œ ì“°ì´ë‚˜?

ìë°” ë¼ì´ë¸ŒëŸ¬ë¦¬

- javax.xml.xpath.XPathFactory#newInstance()
- javax.xml.transform.TransformerFactory#newInstance()
- javax.xml.parsers.DocumentBuilderFactory#newInstance()

```java
// DocumentBuilderFactoryExample.java
package me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._03_java;

import java.io.File;
import java.io.IOException;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;
import org.w3c.dom.Document;
import org.xml.sax.SAXException;

public class DocumentBuilderFactoryExample {

    public static void main(String[] args) throws ParserConfigurationException, IOException, SAXException {
        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
        DocumentBuilder builder = factory.newDocumentBuilder();

        Document document = builder.parse(new File("src/main/resources/config.xml"));
        System.out.println(document.getDocumentElement());
    }
}
```

ìŠ¤í”„ë§

- FactoryBeanê³¼ ê·¸ êµ¬í˜„ì²´

```java
// ShipFactory.java
package me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._03_java;

import me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after.Ship;
import me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after.Whiteship;
import org.springframework.beans.factory.FactoryBean;

public class ShipFactory implements FactoryBean<Ship> {

    @Override
    public Ship getObject() throws Exception {
        Ship ship = new Whiteship();
        ship.setName("whiteship");
        return ship;
    }

    @Override
    public Class<?> getObjectType() {
        return Ship.class;
    }
}

```

```java
// FactoryBeanConfig.java
package me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._03_java;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class FactoryBeanConfig {

    @Bean
    public ShipFactory shipFactory() {
        return new ShipFactory();
    }
}
```

```java
// FactoryBeanExample.java
package me.whiteship.designpatterns._01_creational_patterns._03_abstract_factory._03_java;

import me.whiteship.designpatterns._01_creational_patterns._02_factory_method._02_after.Ship;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class FactoryBeanExample {

    public static void main(String[] args) {
        // **** XML
        // ApplicationContext applicationContext = new ClassPathXmlApplicationContext("config.xml");
        // Ship whiteship = applicationContext.getBean("whiteship", Ship.class);
        // System.out.println(whiteship.getName());

        // **** Java
        ApplicationContext applicationContext = new AnnotationConfigApplicationContext(FactoryBeanConfig.class);
        Ship bean = applicationContext.getBean(Ship.class);
        System.out.println(bean);
    }
}
```

---

## 4. ë¹Œë”(Builder) íŒ¨í„´

### 4.1 íŒ¨í„´ ì†Œê°œ

![gof_1_6](https://raw.githubusercontent.com/berenickt/image-server/main/img/gof_1_6.png)

**ë™ì¼í•œ í”„ë¡œì„¸ìŠ¤ë¥¼ ê±°ì³ ë‹¤ì–‘í•œ êµ¬ì„±ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“œëŠ” ë°©ë²•**.

- (ë³µì¡í•œ) ê°ì²´ë¥¼ ë§Œë“œëŠ” í”„ë¡œì„¸ìŠ¤ë¥¼ ë…ë¦½ì ìœ¼ë¡œ ë¶„ë¦¬í•  ìˆ˜ ìˆë‹¤
- ë³µì¡í•œ ê°ì²´ì˜ ìƒì„± ê³¼ì •ê³¼ í‘œí˜„ ë°©ë²•ì„ ë¶„ë¦¬í•˜ì—¬,
  - ë™ì¼í•œ ìƒì„± ì ˆì°¨ì—ì„œ ì„œë¡œ ë‹¤ë¥¸ í‘œí˜„ ê²°ê³¼ë¥¼ ë§Œë“¤ ìˆ˜ ìˆê²Œ í•˜ëŠ” ë””ìì¸ íŒ¨í„´

![gof_1_7](https://raw.githubusercontent.com/berenickt/image-server/main/img/gof_1_7.png)

e.g. `ë¹Œë” íŒ¨í„´`ì„ ì ìš©í•˜ì—¬ ì—¬í–‰ ê³„íšì„ ë§Œë“œëŠ” ê³¼ì •ì€ ë§ˆì¹˜ **ì—¬í–‰ì‚¬ì—ì„œ ì—¬í–‰ íŒ¨í‚¤ì§€ë¥¼ ì¡°í•©í•˜ëŠ” ê²ƒê³¼ ìœ ì‚¬**í•˜ë‹¤.

- ì—¬í–‰ ê³„íšì„ ë§Œë“¤ê¸° ìœ„í•´, ìš°ë¦¬ëŠ” ì—¬í–‰ì˜ ì œëª©, ì‹œì‘ ë‚ ì§œ, ìˆ™ë°• ì¼ìˆ˜, ìˆ™ì†Œ, ê·¸ë¦¬ê³  ì—¬í–‰ ì¼ì • ë“± ë‹¤ì–‘í•œ ì„¸ë¶€ ì‚¬í•­ì„ ê²°ì •í•´ì•¼ í•œë‹¤.
- ì´ ëª¨ë“  ì •ë³´ë¥¼ í•œ ë²ˆì— ì„¤ì •í•˜ëŠ” ëŒ€ì‹ , ë¹Œë” íŒ¨í„´ì„ ì‚¬ìš©í•˜ë©´ **ì—¬í–‰ ê³„íšì„ ë‹¨ê³„ë³„ë¡œ êµ¬ì„±**í•  ìˆ˜ ìˆë‹¤.

> 1. **ì—¬í–‰ ê³„íš ì‹œì‘**: ë¨¼ì €, ì—¬í–‰ ê³„íšì„ ë§Œë“¤ê¸° ìœ„í•œ ë¹Œë” ê°ì²´ë¥¼ ìƒì„±í•œë‹¤. ì´ ê°ì²´ëŠ” ì—¬í–‰ ê³„íšì˜ ê¸°ì´ˆë¥¼ ë§ˆë ¨í•œë‹¤.
> 2. **ì„¸ë¶€ ì‚¬í•­ ì¶”ê°€**: ë¹Œë” ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬í–‰ ê³„íšì˜ ì„¸ë¶€ ì‚¬í•­ì„ ë‹¨ê³„ë³„ë¡œ ì¶”ê°€í•œë‹¤.
>    - e.g. ì—¬í–‰ì˜ ì œëª©ì„ ì„¤ì •í•˜ê³ , ì—¬í–‰ì˜ ì‹œì‘ ë‚ ì§œë¥¼ ì§€ì •í•œë‹¤.
>    - ê·¸ ë‹¤ìŒ, ìˆ™ë°• ì¼ìˆ˜ì™€ ìˆ™ì†Œë¥¼ ê²°ì •í•˜ê³ , ì—¬í–‰ ì¼ì •ì— ì—¬ëŸ¬ í™œë™ì„ ì¶”ê°€í•œë‹¤.
>    - ì´ ê³¼ì •ì—ì„œ ê° ë‹¨ê³„ëŠ” ë©”ì†Œë“œ ì²´ì´ë‹ì„ í†µí•´ ì—°ê²°ë˜ì–´, ì½”ë“œì˜ ê°€ë…ì„±ì„ ë†’ì¸ë‹¤.
> 3. **ì—¬í–‰ ê³„íš ì™„ì„±**: ëª¨ë“  ì„¸ë¶€ ì‚¬í•­ì„ ì¶”ê°€í•œ í›„, ë¹Œë” ê°ì²´ëŠ” ìµœì¢…ì ìœ¼ë¡œ ì—¬í–‰ ê³„íš ê°ì²´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
>    - ì´ ê°ì²´ëŠ” ì•ì„œ ì„¤ì •í•œ ëª¨ë“  ì„¸ë¶€ ì‚¬í•­ì„ í¬í•¨í•©ë‹ˆë‹¤.

ë¹Œë” íŒ¨í„´ì˜ ì¥ì ì€ ì—¬í–‰ ê³„íšê³¼ ê°™ì€ ë³µì¡í•œ ê°ì²´ë¥¼ ìœ ì—°í•˜ê³  ì§ê´€ì ìœ¼ë¡œ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤.

- ê° ë‹¨ê³„ì—ì„œ í•„ìš”í•œ ì •ë³´ë§Œì„ ì„¤ì •í•  ìˆ˜ ìˆìœ¼ë©°, **ëª¨ë“  ì„¸ë¶€ ì‚¬í•­ì„ í•œ ë²ˆì— ì„¤ì •í•  í•„ìš”ê°€ ì—†ë‹¤**.
- ë˜í•œ, ë¹Œë” íŒ¨í„´ì€ **ì„ íƒì ì¸ ì„¸ë¶€ ì‚¬í•­ì„ ì‰½ê²Œ ì²˜ë¦¬**í•  ìˆ˜ ìˆê²Œ í•´ì£¼ë©°, ìµœì¢… ê°ì²´ì˜ ìƒì„± ê³¼ì •ì„ ë” ëª…í™•í•˜ê³  ì´í•´í•˜ê¸° ì‰½ê²Œ ë§Œë“¤ì–´ ì¤€ë‹¤.

---

### 4.2 ì˜ˆì‹œ - ê¸°ì¡´

```java
// TourPlan.java
package me.whiteship.designpatterns._01_creational_patterns._04_builder._01_before;

import java.time.LocalDate;
import java.util.List;

public class TourPlan {

    private String title;

    private int nights;

    private int days;

    private LocalDate startDate;

    private String whereToStay;

    private List<DetailPlan> plans;

    public TourPlan() {
    }

    public TourPlan(String title, int nights, int days, LocalDate startDate, String whereToStay,
            List<DetailPlan> plans) {
        this.title = title;
        this.nights = nights;
        this.days = days;
        this.startDate = startDate;
        this.whereToStay = whereToStay;
        this.plans = plans;
    }

    @Override
    public String toString() {
        return "TourPlan{" + "title='" + title + '\'' + ", nights=" + nights + ", days=" + days + ", startDate="
                + startDate + ", whereToStay='" + whereToStay + '\'' + ", plans=" + plans + '}';
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public int getNights() {
        return nights;
    }

    public void setNights(int nights) {
        this.nights = nights;
    }

    public int getDays() {
        return days;
    }

    public void setDays(int days) {
        this.days = days;
    }

    public LocalDate getStartDate() {
        return startDate;
    }

    public void setStartDate(LocalDate startDate) {
        this.startDate = startDate;
    }

    public String getWhereToStay() {
        return whereToStay;
    }

    public void setWhereToStay(String whereToStay) {
        this.whereToStay = whereToStay;
    }

    public List<DetailPlan> getPlans() {
        return plans;
    }

    public void setPlans(List<DetailPlan> plans) {
        this.plans = plans;
    }

    public void addPlan(int day, String plan) {
        this.plans.add(new DetailPlan(day, plan));
    }
}
```

```java
// DetailPlan.java
package me.whiteship.designpatterns._01_creational_patterns._04_builder._01_before;

public class DetailPlan {

    private int day;

    private String plan;

    public DetailPlan(int day, String plan) {
        this.day = day;
        this.plan = plan;
    }

    public int getDay() {
        return day;
    }

    public void setDay(int day) {
        this.day = day;
    }

    public String getPlan() {
        return plan;
    }

    public void setPlan(String plan) {
        this.plan = plan;
    }

    @Override
    public String toString() {
        return "DetailPlan{" + "day=" + day + ", plan='" + plan + '\'' + '}';
    }
}
```

```java
// App.class
package me.whiteship.designpatterns._01_creational_patterns._04_builder._01_before;

import java.time.LocalDate;

public class App {

    public static void main(String[] args) {
        TourPlan shortTrip = new TourPlan();
        shortTrip.setTitle("ì˜¤ë ˆê³¤ ë¡±ë¹„ì¹˜ ì—¬í–‰");
        shortTrip.setStartDate(LocalDate.of(2021, 7, 15));

        TourPlan tourPlan = new TourPlan();
        tourPlan.setTitle("ì¹¸ì¿¤ ì—¬í–‰");
        tourPlan.setNights(2);
        tourPlan.setDays(3);
        tourPlan.setStartDate(LocalDate.of(2020, 12, 9));
        tourPlan.setWhereToStay("ë¦¬ì¡°íŠ¸");
        tourPlan.addPlan(0, "ì²´í¬ì¸ ì´í›„ ì§í’€ê¸°");
        tourPlan.addPlan(0, "ì €ë… ì‹ì‚¬");
        tourPlan.addPlan(1, "ì¡°ì‹ ë¶€í˜ì—ì„œ ì‹ì‚¬");
        tourPlan.addPlan(1, "í•´ë³€ê°€ ì‚°ì±…");
        tourPlan.addPlan(1, "ì ì‹¬ì€ ìˆ˜ì˜ì¥ ê·¼ì²˜ ìŒì‹ì ì—ì„œ ë¨¹ê¸°");
        tourPlan.addPlan(1, "ë¦¬ì¡°íŠ¸ ìˆ˜ì˜ì¥ì—ì„œ ë†€ê¸°");
        tourPlan.addPlan(1, "ì €ë…ì€ BBQ ì‹ë‹¹ì—ì„œ ìŠ¤í…Œì´í¬");
        tourPlan.addPlan(2, "ì¡°ì‹ ë¶€í˜ì—ì„œ ì‹ì‚¬");
        tourPlan.addPlan(2, "ì²´í¬ì•„ì›ƒ");
    }
}
```

---

### 4.3 ì˜ˆì‹œ - ë³€ê²½

```java
// TourPlanBuilder.java
package me.whiteship.designpatterns._01_creational_patterns._04_builder._02_after;

import me.whiteship.designpatterns._01_creational_patterns._04_builder._01_before.TourPlan;

import java.time.LocalDate;

public interface TourPlanBuilder {

    TourPlanBuilder nightsAndDays(int nights, int days);

    TourPlanBuilder title(String title);

    TourPlanBuilder startDate(LocalDate localDate);

    TourPlanBuilder whereToStay(String whereToStay);

    TourPlanBuilder addPlan(int day, String plan);

    TourPlan getPlan();

}
```

```java
// DefaultTourBuilder.java
package me.whiteship.designpatterns._01_creational_patterns._04_builder._02_after;

import me.whiteship.designpatterns._01_creational_patterns._04_builder._01_before.DetailPlan;
import me.whiteship.designpatterns._01_creational_patterns._04_builder._01_before.TourPlan;

import java.time.LocalDate;
import java.util.ArrayList;
import java.util.List;

public class DefaultTourBuilder implements TourPlanBuilder {

    private String title;

    private int nights;

    private int days;

    private LocalDate startDate;

    private String whereToStay;

    private List<DetailPlan> plans;

    @Override
    public TourPlanBuilder nightsAndDays(int nights, int days) {
        this.nights = nights;
        this.days = days;
        return this;
    }

    @Override
    public TourPlanBuilder title(String title) {
        this.title = title;
        return this;
    }

    @Override
    public TourPlanBuilder startDate(LocalDate startDate) {
        this.startDate = startDate;
        return this;
    }

    @Override
    public TourPlanBuilder whereToStay(String whereToStay) {
        this.whereToStay = whereToStay;
        return this;
    }

    @Override
    public TourPlanBuilder addPlan(int day, String plan) {
        if (this.plans == null) {
            this.plans = new ArrayList<>();
        }

        this.plans.add(new DetailPlan(day, plan));
        return this;
    }

    @Override
    public TourPlan getPlan() {
        return new TourPlan(title, nights, days, startDate, whereToStay, plans);
    }
}
```

```java
// TourDirector.java
package me.whiteship.designpatterns._01_creational_patterns._04_builder._02_after;

import java.time.LocalDate;
import me.whiteship.designpatterns._01_creational_patterns._04_builder._01_before.TourPlan;

public class TourDirector {

  private TourPlanBuilder tourPlanBuilder;

  public TourDirector(TourPlanBuilder tourPlanBuilder) {
    this.tourPlanBuilder = tourPlanBuilder;
  }

  public TourPlan cancunTrip() {
    return tourPlanBuilder
      .title("ì¹¸ì¿¤ ì—¬í–‰")
      .nightsAndDays(2, 3)
      .startDate(LocalDate.of(2020, 12, 9))
      .whereToStay("ë¦¬ì¡°íŠ¸")
      .addPlan(0, "ì²´í¬ì¸í•˜ê³  ì§ í’€ê¸°")
      .addPlan(0, "ì €ë… ì‹ì‚¬")
      .getPlan();
  }

  public TourPlan longBeachTrip() {
    return tourPlanBuilder
      .title("ë¡±ë¹„ì¹˜")
      .startDate(LocalDate.of(2021, 7, 15))
      .getPlan();
  }
}
```

```java
// App.java
package me.whiteship.designpatterns._01_creational_patterns._04_builder._02_after;

import me.whiteship.designpatterns._01_creational_patterns._04_builder._01_before.TourPlan;

public class App {

    public static void main(String[] args) {
        TourDirector director = new TourDirector(new DefaultTourBuilder());
        TourPlan tourPlan = director.cancunTrip();
        TourPlan tourPlan1 = director.longBeachTrip();
    }
}
```

---

### 4.4 ì¥ë‹¨ì 

- ì¥ì 
  - **ë§Œë“¤ê¸° ë³µì¡í•œ ê°ì²´ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤**.
  - ë³µì¡í•œ ê°ì²´ë¥¼ ë§Œë“œëŠ” êµ¬ì²´ì ì¸ ê³¼ì •ì„ ìˆ¨ê¸¸ ìˆ˜ ìˆë‹¤.
  - ë™ì¼í•œ í”„ë¡œì„¸ìŠ¤ë¥¼ í†µí•´ ê°ê¸° ë‹¤ë¥´ê²Œ êµ¬ì„±ëœ ê°ì²´ë¥¼ ë§Œë“¤ ìˆ˜ë„ ìˆë‹¤.
  - ë¶ˆì™„ì „í•œ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì§€ ëª»í•˜ë„ë¡ ë°©ì§€í•  ìˆ˜ ìˆë‹¤.
- ë‹¨ì 
  - **ì›í•˜ëŠ” ê°ì²´ë¥¼ ë§Œë“¤ë ¤ë©´ ë¹Œë”ë¶€í„° ë§Œë“¤ì–´ì•¼ í•œë‹¤.**
  - êµ¬ì¡°ê°€ ë³µì¡í•´ ì§„ë‹¤. (íŠ¸ë ˆì´ë“œ ì˜¤í”„)

---

### 4.5 ì‹¤ë¬´ì—ì„œ ì–´ë–»ê²Œ ì“°ì´ë‚˜?

ìë°” 8 Stream.Buidler API

```java
// StreamExample.java
package me.whiteship.designpatterns._01_creational_patterns._04_builder._03_java;

import java.util.stream.Stream;

public class StreamExample {

    public static void main(String[] args) {
        Stream<String> names = Stream.<String>builder().add("keesun").add("whiteship").build();
        names.forEach(System.out::println);
    }
}
```

StringBuilderëŠ” ë¹Œë” íŒ¨í„´ì¼ê¹Œ?

```java
// StringBuilderExample.java
package me.whiteship.designpatterns._01_creational_patterns._04_builder._03_java;

public class StringBuilderExample {

    public static void main(String[] args) {
        StringBuilder stringBuilder = new StringBuilder();
        String result = stringBuilder.append("whiteship").append("keesun").toString();
        System.out.println(result);
    }
}

```

ë¡¬ë³µì˜ @Builder

- https://projectlombok.org/features/Builder

```java
package me.whiteship.designpatterns._01_creational_patterns._04_builder._03_java;

import lombok.Builder;

@Builder
public class LombokExample {

  private String title;

  private int nights;

  private int days;

  public static void main(String[] args) {
    LombokExample trip = LombokExample
      .builder()
      .title("ì—¬í–‰")
      .nights(2)
      .days(3)
      .build();
  }
}
```

ìŠ¤í”„ë§

- UriComponentsBuilder
- MockMvcWebClientBuilder
- â€¦Builder

```java
// SpringExample.java
package me.whiteship.designpatterns._01_creational_patterns._04_builder._03_java;

import org.springframework.web.util.UriComponents;
import org.springframework.web.util.UriComponentsBuilder;

public class SpringExample {

  public static void main(String[] args) {
    UriComponents howToStudyJava = UriComponentsBuilder
      .newInstance()
      .scheme("http")
      .host("www.whiteship.me")
      .path("java playlist ep1")
      .build()
      .encode();
    System.out.println(howToStudyJava);
  }
}
```

---

## 5. í”„ë¡œí† íƒ€ì…(Prototype) íŒ¨í„´

![gof_1_8](https://raw.githubusercontent.com/berenickt/image-server/main/img/gof_1_8.png)

**ê¸°ì¡´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë³µì œí•˜ì—¬ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“œëŠ” ë°©ë²•**

- ë³µì œ ê¸°ëŠ¥ì„ ê°–ì¶”ê³  ìˆëŠ” ê¸°ì¡´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í”„ë¡œí† íƒ€ì…ìœ¼ë¡œ ì‚¬ ìš©í•´ ìƒˆ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤

![gof_1_9](https://raw.githubusercontent.com/berenickt/image-server/main/img/gof_1_9.png)

e.g. GitHubì—ì„œëŠ” ê°ê°ì˜ ì €ì¥ì†Œ(repository)ê°€ ê³ ìœ í•œ ì„¤ì •, íŒŒì¼, ì´ìŠˆ(issue) ë“±ì„ ê°€ì§€ê³  ìˆë‹¤.

- íŠ¹ì • í”„ë¡œì íŠ¸ë¥¼ ìœ„í•œ ìƒˆë¡œìš´ ì €ì¥ì†Œë¥¼ ë§Œë“¤ ë•Œ, ê¸°ì¡´ ì €ì¥ì†Œì˜ ì„¤ì •ì´ë‚˜ êµ¬ì¡°ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•´,
  - **ê¸°ì¡´ ì €ì¥ì†Œë¥¼ ë³µì‚¬í•˜ì—¬ ìƒˆë¡œìš´ ì €ì¥ì†Œë¥¼ ë§Œë“œëŠ” ê²ƒì´ ë” íš¨ìœ¨ì **ì´ë‹¤.
- í”„ë¡œí† íƒ€ì… íŒ¨í„´ì„ ì ìš©í•˜ë©´, ê¸°ì¡´ì˜ GitHub ì €ì¥ì†Œ ê°ì²´ë¥¼ `ë³µì‚¬(clone)`í•˜ì—¬ ìƒˆë¡œìš´ ì €ì¥ì†Œ ê°ì²´ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.
  - ì´ ê³¼ì •ì—ì„œ ê¸°ì¡´ ì €ì¥ì†Œì˜ ì„¤ì •, íŒŒì¼ êµ¬ì¡°, ì´ìŠˆ í…œí”Œë¦¿ ë“±ì´ ìƒˆë¡œìš´ ì €ì¥ì†Œë¡œ ë³µì‚¬ëœë‹¤.
  - ë³µì‚¬ëœ ìƒˆ ê°ì²´ëŠ” í•„ìš”ì— ë”°ë¼ ì¶”ê°€ì ì¸ ìˆ˜ì •ì„ ê±°ì³ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤.

í”„ë¡œí† íƒ€ì… íŒ¨í„´ì˜ í•µì‹¬ì€ `ë³µì‚¬`ì™€ `ìˆ˜ì •`ì´ë‹¤.

- ê¸°ì¡´ ê°ì²´ë¥¼ ë³µì‚¬í•˜ì—¬ ìƒˆ ê°ì²´ë¥¼ ë§Œë“¤ê³ , ì´ ìƒˆ ê°ì²´ì— ëŒ€í•´ í•„ìš”í•œ ìˆ˜ì •ì„ ìˆ˜í–‰í•¨ìœ¼ë¡œì¨,
  - **ê°ì²´ ìƒì„± ê³¼ì •ì„ ê°„ì†Œí™”í•˜ê³ , íš¨ìœ¨ì„±ì„ ë†’ì¼ ìˆ˜ ìˆë‹¤**.
- GitHub ì €ì¥ì†Œ ì˜ˆì‹œì—ì„œ ë³¼ ìˆ˜ ìˆë“¯,
  - í”„ë¡œí† íƒ€ì… íŒ¨í„´ì€ **ì„¤ì •ì´ ë³µì¡í•˜ê±°ë‚˜, ê°ì²´ì˜ ìƒíƒœê°€ ë‹¤ì–‘í•˜ê²Œ ë³€í•  ìˆ˜ ìˆëŠ” ìƒí™©ì—ì„œ íŠ¹íˆ ìœ ìš©**í•©ë‹ˆë‹¤.

---

### 5.1 ì˜ˆì‹œ - ê¸°ì¡´

```java
// GithubRepository.java
package me.whiteship.designpatterns._01_creational_patterns._05_prototype._01_before;

public class GithubRepository {

  private String user;

  private String name;

  public String getUser() {
    return user;
  }

  public void setUser(String user) {
    this.user = user;
  }

  public String getName() {
    return name;
  }

  public void setName(String name) {
    this.name = name;
  }
}
```

```java
// GithubIssue.java
package me.whiteship.designpatterns._01_creational_patterns._05_prototype._01_before;

public class GithubIssue {

  private int id;

  private String title;

  private GithubRepository repository;

  public GithubIssue(GithubRepository repository) {
    this.repository = repository;
  }

  public int getId() {
    return id;
  }

  public void setId(int id) {
    this.id = id;
  }

  public String getTitle() {
    return title;
  }

  public void setTitle(String title) {
    this.title = title;
  }

  public GithubRepository getRepository() {
    return repository;
  }

  public String getUrl() {
    return String.format(
      "https://github.com/%s/%s/issues/%d",
      repository.getUser(),
      repository.getName(),
      this.getId()
    );
  }
}
```

```java
// App.java
package me.whiteship.designpatterns._01_creational_patterns._05_prototype._01_before;

public class App {

    public static void main(String[] args) {
        GithubRepository repository = new GithubRepository();
        repository.setUser("whiteship");
        repository.setName("live-study");

        GithubIssue githubIssue = new GithubIssue(repository);
        githubIssue.setId(1);
        githubIssue.setTitle("1ì£¼ì°¨ ê³¼ì œ: JVMì€ ë¬´ì—‡ì´ë©° ìë°” ì½”ë“œëŠ” ì–´ë–»ê²Œ ì‹¤í–‰í•˜ëŠ” ê²ƒì¸ê°€.");

        String url = githubIssue.getUrl();
        System.out.println(url);
    }

}
```

---

### 5.2 ì˜ˆì‹œ - ë³€ê²½

```java
// GithubIssue.java
package me.whiteship.designpatterns._01_creational_patterns._05_prototype._02_after;

import java.util.Objects;

public class GithubIssue implements Cloneable {

  private int id;

  private String title;

  private GithubRepository repository;

  public GithubIssue(GithubRepository repository) {
    this.repository = repository;
  }

  public int getId() {
    return id;
  }

  public void setId(int id) {
    this.id = id;
  }

  public String getTitle() {
    return title;
  }

  public void setTitle(String title) {
    this.title = title;
  }

  public GithubRepository getRepository() {
    return repository;
  }

  public String getUrl() {
    return String.format(
      "https://github.com/%s/%s/issues/%d",
      repository.getUser(),
      repository.getName(),
      this.getId()
    );
  }

  @Override
  protected Object clone() throws CloneNotSupportedException {
    GithubRepository repository = new GithubRepository();
    repository.setUser(this.repository.getUser());
    repository.setName(this.repository.getName());

    GithubIssue githubIssue = new GithubIssue(repository);
    githubIssue.setId(this.id);
    githubIssue.setTitle(this.title);

    return githubIssue;
  }

  @Override
  public boolean equals(Object o) {
    if (this == o) return true;
    if (o == null || getClass() != o.getClass()) return false;
    GithubIssue that = (GithubIssue) o;
    return (
      id == that.id &&
      Objects.equals(title, that.title) &&
      Objects.equals(repository, that.repository)
    );
  }

  @Override
  public int hashCode() {
    return Objects.hash(id, title, repository);
  }
}
```

```java
// App.java
package me.whiteship.designpatterns._01_creational_patterns._05_prototype._02_after;

public class App {

    public static void main(String[] args) throws CloneNotSupportedException {
        GithubRepository repository = new GithubRepository();
        repository.setUser("whiteship");
        repository.setName("live-study");

        GithubIssue githubIssue = new GithubIssue(repository);
        githubIssue.setId(1);
        githubIssue.setTitle("1ì£¼ì°¨ ê³¼ì œ: JVMì€ ë¬´ì—‡ì´ë©° ìë°” ì½”ë“œëŠ” ì–´ë–»ê²Œ ì‹¤í–‰í•˜ëŠ” ê²ƒì¸ê°€.");

        String url = githubIssue.getUrl();
        System.out.println(url);

        GithubIssue clone = (GithubIssue) githubIssue.clone();
        System.out.println(clone.getUrl());

        repository.setUser("Keesun");

        System.out.println(clone != githubIssue);
        System.out.println(clone.equals(githubIssue));
        System.out.println(clone.getClass() == githubIssue.getClass());
        System.out.println(clone.getRepository() == githubIssue.getRepository());

        System.out.println(clone.getUrl());
    }

}
```

---

### 5.3 ì¥ë‹¨ì 

- ì¥ì 
  - **ë³µì¡í•œ ê°ì²´ë¥¼ ë§Œë“œëŠ” ê³¼ì •ì„ ìˆ¨ê¸¸ ìˆ˜ ìˆë‹¤**.
  - ê¸°ì¡´ ê°ì²´ë¥¼ ë³µì œí•˜ëŠ” ê³¼ì •ì´ ìƒˆ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“œëŠ” ê²ƒë³´ë‹¤ ë¹„ìš©(ì‹œê°„ ë˜ëŠ” ë©”ëª¨ë¦¬)ì ì¸ ë©´ì—ì„œ íš¨ìœ¨ì ì¼ ìˆ˜ë„ ìˆë‹¤.
  - ì¶”ìƒì ì¸ íƒ€ì…ì„ ë¦¬í„´í•  ìˆ˜ ìˆë‹¤.
- ë‹¨ì 
  - ë³µì œí•œ ê°ì²´ë¥¼ ë§Œë“œëŠ” ê³¼ì • ìì²´ê°€ ë³µì¡í•  ìˆ˜ ìˆë‹¤. (íŠ¹íˆ, ìˆœí™˜ ì°¸ì¡°ê°€ ìˆëŠ” ê²½ìš°)

---

### 5.4 ì‹¤ë¬´ì—ì„œ ì–´ë–»ê²Œ ì“°ì´ë‚˜?

- ìë°” Object í´ë˜ìŠ¤ì˜ clone ë©”ì†Œë“œì™€ Cloneable ì¸í„°í˜ì´ìŠ¤
- shallow copyì™€ deep copy
- ModelMapper

```java
// ModelMapperExample.java
package me.whiteship.designpatterns._01_creational_patterns._05_prototype._03_java;

import me.whiteship.designpatterns._01_creational_patterns._05_prototype._02_after.GithubIssue;
import me.whiteship.designpatterns._01_creational_patterns._05_prototype._02_after.GithubRepository;
import org.modelmapper.ModelMapper;

public class ModelMapperExample {

    public static void main(String[] args) {
        GithubRepository repository = new GithubRepository();
        repository.setUser("whiteship");
        repository.setName("live-study");

        GithubIssue githubIssue = new GithubIssue(repository);
        githubIssue.setId(1);
        githubIssue.setTitle("1ì£¼ì°¨ ê³¼ì œ: JVMì€ ë¬´ì—‡ì´ë©° ìë°” ì½”ë“œëŠ” ì–´ë–»ê²Œ ì‹¤í–‰í•˜ëŠ” ê²ƒì¸ê°€.");

        ModelMapper modelMapper = new ModelMapper();
        GithubIssueData githubIssueData = modelMapper.map(githubIssue, GithubIssueData.class);
        System.out.println(githubIssueData);
    }
}
```

```java
// JavaCollectionExample.java
package me.whiteship.designpatterns._01_creational_patterns._05_prototype._03_java;

import java.util.ArrayList;
import java.util.List;

public class JavaCollectionExample {

    public static void main(String[] args) {
        Student keesun = new Student("keesun");
        Student whiteship = new Student("whiteship");
        List<Student> students = new ArrayList<>();
        students.add(keesun);
        students.add(whiteship);

        List<Student> clone = new ArrayList<>(students);
        System.out.println(clone);
    }
}
```
