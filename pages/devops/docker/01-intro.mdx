---
title: '01-Docker 왜 쓰나'
date: 2024/02/05
---

## 1. 설치해야할 프로그램

### 1.1 Windows

- Git, Git Bash 설치
- Docker Desktop, WSL 설치
- VSCode 설치

---

### 2.1 Mac

- iTerm2 설치
- Git 설치
- Docker Desktop 설치
- VSCode 설치

설치할 프로그램을 다 받으면, 실습용으로 쓸 폴더를 하나 만들어서 vscode로 연다.

- cf. https://docs.docker.com/desktop/install/mac-install/
- https://www.docker.com/ 도커 홈페이지에 접속한 뒤, Get Started를 클릭
- OS에 맞게 다운로드하고, 설치하고, 재부팅한다.

---

### cf. 실행 중인 컨테이너 모두 삭제

```bash
# [MacOS] 실행 중인 컨테이너 모두 삭제
docker rm -f $(docker ps -aq)

# [Windows] 실행 중인 컨테이너 모두 삭제
docker ps -aq | ForEach-Object {docker rm -f $_}
```

---

## 2. Docker를 사용해서 배포하는 이유

새로 컴퓨터를 샀다거나 또는 새로 직원이 들어왔다고 생각해봅시다.
그럼 컴퓨터에 우리가 개발한 환경과 똑같이 만들어야합니다.

이를 위해 Node.js와 같은 언어 그리고 언어의 버전, 데이터베이스,
수 많은 node_modules를 버전을 맞춰서 설치해줘야 합니다. 한 두가지가 아니겠죠.

그래서 예전 회사에서는 환경을 구축하는 과정을 하나씩 캡쳐하고, 기록해서 방법을 정리해두기도 합니다.
가이드 문서가 있다고 한들 **매번 이렇게 구축하는 것은 매우 번거로운 일**입니다.
그리고 **컴퓨터 안에 컴퓨터가 또 있으니까 너무 느린 것도 문제점**이었습니다.

이를 간편하게 해주는 것이 바로 도커입니다.
부팅 등 운영체제의 핵심 기능(커널)을 공유하는 가상머신이 Docker입니다.

그래서 OS 전체를 새로 설치하지 않아도 됩니다.
즉, 신입사원이 들어오더라도 도커 파일만 주면, 도커 실행시킬줄만 알면 1시간이면 세팅 시간이 끝납니다.

> 💡 cf. Window에서는 WSL도 같이 설치해줘야 됩니다.
>
> Docker 커널 기능은 Linux로 통일되어 있습니다.
> 그래서 window, macOs, linux 등 운영체제 신경안써도 됩니다.

> 💡 도커 쓰는 이유 정리
>
> 1. 개발/배포 환경 통일
> 2. 프로그램 미리 설치
> 3. 가벼운 가상 컴퓨터

---

## 3. Docker란?

도커는 개발 환경 요소들이 설치된 모습을 이미지로 저장합니다. 저장한 이미지를 클라우드에 올립니다.
이미지들이 서로 연결되서 동작하는 설정을 `문서(Dockerfile)`로 저장합니다.
새 컴퓨터에 가서 복사한 문서의 내용대로 이미지를 다운받아 설치합니다.

![정적 배포](https://raw.githubusercontent.com/berenickt/image-server/main/img/docker-file.png)

> 출처 cf. https://medium.com/@darkrasid/docker%EC%99%80-vm-d95d60e56fdd

가상 머신과 비슷하다고 볼 수 있습니다. 하지만 가상머신보다 훨씬 빠르고, 자원을 효율적으로 사용합니다.
왼쪽이 가상머신, 오른쪽이 도커입니다. 도커에는 불필요한 추가적인 운영체제 설치가 필요 없습니다.

> cf. 가상머신을 활용한 도구로는 VMware, VirtualBox, Parallels(mac용) 등이 있습니다.
> 한 대의 컴퓨터에서 여러 운영체제를 동시에 수행 가능

도커 허브에서는 npm 다운 받는 것처럼 **다른 사람들이 올려놓은 이미지를 다운로드**할 수도 있습니다.
또한, 한 컴퓨터에서 다른 환경의 여러 서비스를 실행해야 하는 경우,
컨테이너로 분리되어 있기 때문에 서로 독립되어 실행 될 수 있습니다.

이것들을 모두 간단한 명령어로 실행 할 수 있습니다.

---

### 3.1 Docker 컨테이너와 이미지

#### 3.1.1 유저랜드

- OS는 메모리 사용을 기준으로 `커널 공간`과 `유저 공간`으로 나눌 수 있음
- **유저 공간에서 실행되는 실행 파일과 라이브러리**를 `유저랜드(userland)`라고 부름
  - 보통 리눅스 배포판에서 유저랜드는 부팅에 필요한 실행 파일과 라이브러리, 고유의 패키징 시스템을 포함됨
  - 보통 리눅스 배포판 이름으로 되어 있음 (e.g. Ubuntu, CentOS, Debian 등)
  - But. 운영체제의 사용자 공간을 가리키는 용어이기 때문에, 리눅스 배포판의 이름과 직접적으로 관련없음

#### 3.1.2 Docker 이미지

- `베이스 이미지` : **유저랜드만 설치된 파일**을 의미
- `Docker 이미지` : 베이스 이미지에 필요한 프로그램과 라이브러리, 소스를 설치한 뒤 파일 하나로 만든 것
  - Docker 이미지는 16진수로 된 ID로 구분하고, 각각의 이미지는 독립적
  - 이미지를 통째로 생성하지 않고, 바뀐 부분만 생성한 뒤, 부모 이미지를 계속 참조하는 방식으로 동작
  - Docker에서는 이를 `레이어`라고 부름

#### 3.1.3 Docker 컨테이너

- `Docker 컨테이너` : **이미지를 실행한 상태**
  - 이미지로 여러 개의 컨테이너를 만들 수 있음
- 운영체제로 비유하면,
  - `이미지`는 실행 파일이고, `컨테이너`는 프로세스
- `Docker === 특정 실행 파일 또는 스크립트를 위한 실행 환경`
