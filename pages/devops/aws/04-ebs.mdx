---
title: '04-EBS'
date: 2024/01/10
---

## 1. EBS

- EBS는 **Elastic Block Store**의 약자
- EBS는 **EC2에 attach해서 쓸 수 있는 블록 스토리지**를 의미
  - attach는 **연결한다**는 의미
- 단일 가용 영역 내에서 여러 서버에 걸쳐서 복제
- 특정 시점에 대한 볼륨 스냅샷을 만들 수 있음
  - cf. 스냅샷은 쉽게 말해 **백업 파일**이라고 생각하면 됨
  - 스냅샷은 S3라는 객체 기반 스토리지에 저장되며,
  - 복수 개의 가용영역에 걸쳐 자동으로 복제됨

---

### 1.1 EBS의 특징

- 한 개의 EBS를 **여러 개의 EC2 인스턴스에 attach하는 것은 불가능**
- 하지만 반대로 한 개의 EC2에 여러 개의 EBS를 attach하는 것은 가능
- e.g. 하나의 컴퓨터에 용량을 늘리기 위해 SSD를 여러개 연결할 수 있지만,
  - 하나의 SSD를 여러 대의 컴퓨터에 동시에 연결할 수는 없는 것과 같은 의미

---

## 2. EBS 관련 용어

- `볼륨 (Volume)` : 가장 기본적인 형태로 EC2에 바로 attach 가능한 형태를 의미
- `스냅샷 (Snapshot)`
  - 볼륨의 특정 시점을 그대로 복사하여 저장한 파일
  - 스냅샷을 이용하여 볼륨 및 AMI(Amazon Machine Image) 생성 가능
- `AMI (Amazon Machine Image)`
  - OS가 설치된 형태의 이미지 파일
  - AMI를 이용하여 EC2 인스턴스 생성 가능
  - cf. 앞에 EC2 인스턴스를 생성할 때 AMI를 선택하는 과정이 있었음
    - Ubuntu가 설치된 AMI를 선택했었음
- `IOPS (Input/Output Operations Per Second)`
  - 저장 장치의 성능 측정 단위
  - 이 숫자가 높을수록 같은 시간동안 더 많은 입력과 출력 작업을 할 수 있음
  - 16KB 단위로 처리됨
  - 추가 비용을 지불하여 더 높은 IOPS의 EBS를 생성 할 수 있음

---

## 3. (실습) EBS 볼륨 생성

[EC2] → 왼쪽 메뉴에 [Elastic Block Store]의 [볼륨] 메뉴를 클릭

- EC2 인스턴스를 생성할 때, 기본적으로 볼륨을 하나 생성하도록 되어 있기 때문에 현재 하나의 볼륨이 이미 존재한다.

  - (종료되서 자동 삭제됐으면 다시 인스턴스 생성하기)

- 해당 볼륨을 체크해서 클릭하면, 하단에 해당 볼륨에 대한 상세 정보가 나온다.

  - 하단에 [가용 영역]이 뭘로 되어 있는지 기억해두기.
  - 가용 영역은 현재 EC2 인스턴스가 생성된 가용 영역인데,
  - 볼륨을 생성할 때, 동일한 가용 영역에 생성해야만 EC2 인스턴스와 연결할 수 있다.

- 오른쪽 상단에 있는 [볼륨 생성] 버튼을 클릭

---

(볼륨 생성) 페이지

- `볼륨 유형` : 범용 SSD(gp2)
- `크기(GiB)` ,`IOPS` ,`처리량(MiB/s)` 전부 그대로
- `가용 영역` : 위에서 기억해둔 **EC2 인스턴스와 동일한 가용영역** 선택

화면을 아래로 내려서 하단에 있는 [볼륨 생성] 버튼을 눌러서 볼륨을 생성하기

---

새로 생성된 볼륨을 체크해서 누른 후, 상세보기를 본다.

- 볼륨 상태가 아직 [생성 중]으로 나오고,
  - 시간이 좀 지나면, 볼륨 상태가 [사용 가능]으로 바뀌게 된다.
- 볼륨을 EC2에 연결하기 위해 오른쪽 상단의 [작업] 메뉴를 누른다.
  - 그리고 나오는 하위 메뉴에서 [볼륨 연결] 메뉴를 클릭합니다.

---

(볼륨 연결) 페이지

- `인스턴스` : 인스턴스 메뉴를 클릭
  - 그러면 현재 실행 중인 인스턴스의 목록이 나온다.
  - 여기서 인스턴스 ID와 생성할 때 입력한 이름을 확인 가능
- 여기서는 하나의 인스턴스만 생성했기 때문에,
  - 목록에 하나만 나오게 되는데 이 인스턴스를 클릭
- 설정이 끝났으면, 오른쪽 하단에 있는 [볼륨 연결] 버튼을 클릭.

그러면 EC2 인스턴스와 EBS 볼륨의 연결이 시작된다.

- 해당 볼륨의 상세정보를 보면, 세부 정보 탭의 하단에서 [연결된 인스턴스]라는 속성을 볼 수 있다.
  - 처음에는 `(attaching, 진행중)`라고 나오다가,
  - 시간이 지나면 `(attached, 진행중)` 상태로 바뀐다.

이제 EC2 인스턴스에서 볼륨을 사용할 수 있는 상태가 된다.

---

## 4. (실습) EBS 스냅샷 생성 및 삭제

### 4.1 EBS 스냅샷 생성

[EC2] → 왼쪽 메뉴에 [Elastic Block Store]의 [볼륨] 메뉴를 클릭

설정한 인스턴스의 오른쪽 상단 [작업] 메뉴를 클릭

- 그리고 나오는 하위 메뉴에서 [스냅샷 생성] 메뉴를 클릭.

---

(스냅샷 생성) 페이지

- 아무것도 입력하지 않고, [스냅샷 생성] 버튼을 클릭

그러면 스냅샷이 생성되는데, 스냅샷 목록을 확인하기 위해서 왼쪽에 있는 [스냅샷] 메뉴를 클릭

- 스냅샷 페이지에 가면, 방금 생성된 스냅샷을 확인할 수 있다.
- 그리고 스냅샷을 누르면 하단에 해당 스냅샷에 대한 상세 정보가 나온다.

---

### 4.2 EBS 스냅샷 삭제

이 상태에서 스냅샷을 삭제해본다.

- 스냅샷을 누르면 하단에 해당 스냅샷에 대한 상세 정보가 나온다.
- 오른쪽 상단의 [작업] 메뉴를 클릭합니다.
- 그리고 나오는 하위 메뉴에서 [스냅샷 삭제]를 클릭합니다.
- 그러면 이렇게 확인 다이얼로그가 뜨고, 여기서 [삭제] 버튼을 누르면 스냅샷이 삭제됩니다.

이렇게 스냅샷이 삭제된다.

---

## 5. (실습) EBS 볼륨 삭제

> 볼륨을 삭제하기 위해서는 해당 볼륨이 EC2 인스턴스에 연결되어 있지 않은 상태여야 한다.
>
> - 왜냐하면, 컴퓨터에 연결해서 사용 중인 SSD를 갑자기 뽑아버리면 문제가 생기겠죠.
> - 마찬가지로 먼저 EBS와 EC2 인스턴스의 연결을 해제해야 한다.

EBS의 볼륨 페이지에서 오른쪽 상단의 [작업] 메뉴를 클릭.

- 그리고 나오는 하위 메뉴에서 [볼륨 분리]를 클릭
  - 그럼 확인 다이얼로그가 뜨고, 여기서 [분리] 버튼을 클릭해서 볼륨을 분리시킨다.
  - 볼륨을 눌러서 상세 정보를 보면,
  - 연결된 인스턴스가 없는 것으로 나오게 된다. (시간이 좀 걸림)
- 연결된 인스턴스가 없는 것을 확인했으면, 다시 [작업] 메뉴를 클릭.
  - 그리고 하위 메뉴에서 [볼륨 삭제]를 클릭
  - 볼륨을 삭제하기 전 확인 다이얼로그가 뜨고, 여기서 [삭제] 버튼을 클릭
  - 그러면 볼륨이 정상적으로 삭제된다.
